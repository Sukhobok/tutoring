(function(a){a.Jcrop=function(e,l){function p(a){return Math.round(a)+"px"}function b(b){b=a(b).offset();return[b.left,b.top]}function c(a){return[a.pageX-L[0],a.pageY-L[1]]}function u(b){"object"!==typeof b&&(b={});h=a.extend(h,b);a.each(["onChange","onSelect","onRelease","onDblClick"],function(a,b){"function"!==typeof h[b]&&(h[b]=function(){})})}function f(a,h,f){L=b(n);V.setCursor("move"===a?a:a+"-resize");if("move"===a)return V.activateHandlers(k(h),v,f);h=C.getFixed();var d=ga(a),c=C.getCorner(ga(d));
C.setPressed(C.getCorner(d));C.setCurrent(c);V.activateHandlers(g(a,h),v,f)}function g(a,b){return function(f){if(h.aspectRatio)switch(a){case "e":f[1]=b.y+1;break;case "w":f[1]=b.y+1;break;case "n":f[0]=b.x+1;break;case "s":f[0]=b.x+1}else switch(a){case "e":f[1]=b.y2;break;case "w":f[1]=b.y2;break;case "n":f[0]=b.x2;break;case "s":f[0]=b.x2}C.setCurrent(f);w.update()}}function k(a){var b=a;ha.watchKeys();return function(a){C.moveOffset([a[0]-b[0],a[1]-b[1]]);b=a;w.update()}}function ga(a){switch(a){case "n":return"sw";
case "s":return"nw";case "e":return"nw";case "w":return"ne";case "ne":return"sw";case "nw":return"se";case "se":return"nw";case "sw":return"ne"}}function z(a){return function(g){if(h.disabled||"move"===a&&!h.allowMove)return!1;L=b(n);Y=!0;f(a,c(g));g.stopPropagation();g.preventDefault();return!1}}function y(a,b,h){var f=a.width(),g=a.height();f>b&&0<b&&(f=b,g=b/a.width()*a.height());g>h&&0<h&&(g=h,f=h/a.height()*a.width());I=a.width()/f;K=a.height()/g;a.width(f).height(g)}function d(a){return{x:a.x*
I,y:a.y*K,x2:a.x2*I,y2:a.y2*K,w:a.w*I,h:a.h*K}}function v(a){a=C.getFixed();a.w>h.minSelect[0]&&a.h>h.minSelect[1]?(w.enableHandles(),w.done()):w.release();V.setCursor(h.allowSelect?"crosshair":"default")}function G(a){if(h.disabled||!h.allowSelect)return!1;Y=!0;L=b(n);w.disableHandles();V.setCursor("crosshair");var f=c(a);C.setPressed(f);w.update();V.activateHandlers(t,v,"touch"===a.type.substring(0,5));ha.watchKeys();a.stopPropagation();a.preventDefault();return!1}function t(a){C.setCurrent(a);
w.update()}function A(){var b=a("<div></div>").addClass(h.baseClass+"-tracker");R&&b.css({opacity:0,backgroundColor:"white"});return b}function D(a){E([a[0]/I,a[1]/K,a[2]/I,a[3]/K]);h.onSelect.call(S,d(C.getFixed()));w.enableHandles()}function E(a){C.setPressed([a[0],a[1]]);C.setCurrent([a[2],a[3]]);w.update()}function M(){h.disabled=!0;w.disableHandles();w.setCursor("default");V.setCursor("default")}function N(){h.disabled=!1;x()}function P(b,f,g){f=f||h.bgColor;h.bgFade&&a.fx.step.hasOwnProperty("backgroundColor")&&
h.fadeTime&&!g?b.animate({backgroundColor:f},{queue:!1,duration:h.fadeTime}):b.css("backgroundColor",f)}function x(a){h.allowResize?a?w.enableOnly():w.enableHandles():w.disableHandles();V.setCursor(h.allowSelect?"crosshair":"default");w.setCursor(h.allowMove?"move":"default");h.hasOwnProperty("trueSize")&&(I=h.trueSize[0]/q,K=h.trueSize[1]/r);h.hasOwnProperty("setSelect")&&(D(h.setSelect),w.done(),delete h.setSelect);W.refresh();h.bgColor!=ja&&(P(h.shade?W.getShades():J,h.shade?h.shadeColor||h.bgColor:
h.bgColor),ja=h.bgColor);ba!=h.bgOpacity&&(ba=h.bgOpacity,h.shade?W.refresh():w.setBgOpacity(ba));ca=h.maxSize[0]||0;da=h.maxSize[1]||0;ea=h.minSize[0]||0;fa=h.minSize[1]||0;h.hasOwnProperty("outerImage")&&(n.attr("src",h.outerImage),delete h.outerImage);w.refresh()}var h=a.extend({},a.Jcrop.defaults),L,O=navigator.userAgent.toLowerCase(),R=/msie/.test(O),B=/msie [1-6]\./.test(O);"object"!==typeof e&&(e=a(e)[0]);"object"!==typeof l&&(l={});u(l);var O={border:"none",visibility:"visible",margin:0,padding:0,
position:"absolute",top:0,left:0},s=a(e),m=!0;if("IMG"==e.tagName){if(0!=s[0].width&&0!=s[0].height)s.width(s[0].width),s.height(s[0].height);else{var H=new Image;H.src=s[0].src;s.width(H.width);s.height(H.height)}var n=s.clone().removeAttr("id").css(O).show();n.width(s.width());n.height(s.height());s.after(n).hide()}else n=s.css(O).show(),m=!1,null===h.shade&&(h.shade=!0);y(n,h.boxWidth,h.boxHeight);var q=n.width(),r=n.height(),J=a("<div />").width(q).height(r).addClass(h.baseClass+"-holder").css({position:"relative",
backgroundColor:h.bgColor}).insertAfter(s).append(n);h.addClass&&J.addClass(h.addClass);var T=a("<div />"),F=a("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),Z=a("<div />").width("100%").height("100%").css("zIndex",320),aa=a("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var a=C.getFixed();h.onDblClick.call(S,a)}).insertBefore(n).append(F,Z);m&&(T=a("<img />").attr("src",n.attr("src")).css(O).width(q).height(r),F.append(T));B&&
aa.css({overflowY:"hidden"});var Q=h.boundary,X=A().width(q+2*Q).height(r+2*Q).css({position:"absolute",top:p(-Q),left:p(-Q),zIndex:290}).mousedown(G),ja=h.bgColor,ba=h.bgOpacity,ca,da,ea,fa,I,K,Y,ia,ka;L=b(n);var U=function(){function a(){var b={},f=["touchstart","touchmove","touchend"],h=document.createElement("div"),g;try{for(g=0;g<f.length;g++){var d=f[g],d="on"+d,c=d in h;c||(h.setAttribute(d,"return;"),c="function"==typeof h[d]);b[f[g]]=c}return b.touchstart&&b.touchend&&b.touchmove}catch(e){return!1}}
var g;g=!0===h.touchSupport||!1===h.touchSupport?h.touchSupport:a();return{createDragger:function(a){return function(g){if(h.disabled||"move"===a&&!h.allowMove)return!1;L=b(n);Y=!0;f(a,c(U.cfilter(g)),!0);g.stopPropagation();g.preventDefault();return!1}},newSelection:function(a){return G(U.cfilter(a))},cfilter:function(a){a.pageX=a.originalEvent.changedTouches[0].pageX;a.pageY=a.originalEvent.changedTouches[0].pageY;return a},isSupported:a,support:g}}(),C=function(){function a(){if(!h.aspectRatio){var b=
e-d,u=m-c;ca&&Math.abs(b)>ca&&(e=0<b?d+ca:d-ca);da&&Math.abs(u)>da&&(m=0<u?c+da:c-da);fa/K&&Math.abs(u)<fa/K&&(m=0<u?c+fa/K:c-fa/K);ea/I&&Math.abs(b)<ea/I&&(e=0<b?d+ea/I:d-ea/I);0>d&&(e-=d,d-=d);0>c&&(m-=c,c-=c);0>e&&(d-=e,e-=e);0>m&&(c-=m,m-=m);e>q&&(b=e-q,d-=b,e-=b);m>r&&(b=m-r,c-=b,m-=b);d>q&&(b=d-r,m-=b,c-=b);c>r&&(b=c-r,m-=b,c-=b);return g(f(d,c,e,m))}var b=h.aspectRatio,u=h.minSize[0]/I,F=h.maxSize[0]/I,x=e-d,l=m-c,k=Math.abs(x),n=Math.abs(l);0===F&&(F=10*q);k/n<b?(k=m,n*=b,n=0>x?d-n:n+d,0>
n?(n=0,k=Math.abs((n-d)/b),k=0>l?c-k:k+c):n>q&&(n=q,k=Math.abs((n-d)/b),k=0>l?c-k:k+c)):(n=e,k/=b,k=0>l?c-k:c+k,0>k?(k=0,n=Math.abs((k-c)*b),n=0>x?d-n:n+d):k>r&&(k=r,n=Math.abs(k-c)*b,n=0>x?d-n:n+d));n>d?(n-d<u?n=d+u:n-d>F&&(n=d+F),k=k>c?c+(n-d)/b:c-(n-d)/b):n<d&&(d-n<u?n=d-u:d-n>F&&(n=d-F),k=k>c?c+(d-n)/b:c-(d-n)/b);0>n?(d-=n,n=0):n>q&&(d-=n-q,n=q);0>k?(c-=k,k=0):k>r&&(c-=k-r,k=r);return g(f(d,c,n,k))}function b(a){0>a[0]&&(a[0]=0);0>a[1]&&(a[1]=0);a[0]>q&&(a[0]=q);a[1]>r&&(a[1]=r);return[Math.round(a[0]),
Math.round(a[1])]}function f(a,b,d,c){var g=a,h=d,e=b,m=c;d<a&&(g=d,h=a);c<b&&(e=c,m=b);return[g,e,h,m]}function g(a){return{x:a[0],y:a[1],x2:a[2],y2:a[3],w:a[2]-a[0],h:a[3]-a[1]}}var d=0,c=0,e=0,m=0,u,F;return{flipCoords:f,setPressed:function(a){a=b(a);e=d=a[0];m=c=a[1]},setCurrent:function(a){a=b(a);u=a[0]-e;F=a[1]-m;e=a[0];m=a[1]},getOffset:function(){return[u,F]},moveOffset:function(a){var b=a[0];a=a[1];0>d+b&&(b-=b+d);0>c+a&&(a-=a+c);r<m+a&&(a+=r-(m+a));q<e+b&&(b+=q-(e+b));d+=b;e+=b;c+=a;m+=
a},getCorner:function(b){var d=a();switch(b){case "ne":return[d.x2,d.y];case "nw":return[d.x,d.y];case "se":return[d.x2,d.y2];case "sw":return[d.x,d.y2]}},getFixed:a}}(),W=function(){function b(){return d(C.getFixed())}function d(a){x.top.css({left:p(a.x),width:p(a.w),height:p(a.y)});x.bottom.css({top:p(a.y2),left:p(a.x),width:p(a.w),height:p(r-a.y2)});x.right.css({left:p(a.x2),width:p(q-a.x2)});x.left.css({width:p(a.x)})}function c(){return a("<div />").css({position:"absolute",backgroundColor:h.shadeColor||
h.bgColor}).appendTo(F)}function f(){u||(u=!0,F.insertBefore(n),b(),w.setBgOpacity(1,0,1),T.hide(),g(h.shadeColor||h.bgColor,1),w.isAwake()?m(h.bgOpacity,1):m(1,1))}function g(a,b){P(k(),a,b)}function e(){u&&(F.remove(),T.show(),u=!1,w.isAwake()?w.setBgOpacity(h.bgOpacity,1,1):(w.setBgOpacity(1,1,1),w.disableHandles()),P(J,0,1))}function m(a,b){u&&(h.bgFade&&!b?F.animate({opacity:1-a},{queue:!1,duration:h.fadeTime}):F.css({opacity:1-a}))}function k(){return F.children()}var u=!1,F=a("<div />").css({position:"absolute",
zIndex:240,opacity:0}),x={top:c(),left:c().height(r),right:c().height(r),bottom:c()};return{update:b,updateRaw:d,getShades:k,setBgColor:g,enable:f,disable:e,resize:function(a,b){x.left.css({height:p(b)});x.right.css({height:p(b)})},refresh:function(){h.shade?f():e();w.isAwake()&&m(h.bgOpacity)},opacity:m}}(),w=function(){function b(d,c){var f=a("<div />").mousedown(z(d)).css({cursor:d+"-resize",position:"absolute",zIndex:c}).addClass("ord-"+d);U.support&&f.bind("touchstart.jcrop",U.createDragger(d));
Z.append(f);return f}function c(a){var d;for(d=0;d<a.length;d++)b(a[d],r++).addClass("jcrop-dragbar")}function f(b){var d,c;for(c=0;c<b.length;c++){switch(b[c]){case "n":d="hline";break;case "s":d="hline bottom";break;case "e":d="vline right";break;case "w":d="vline"}var g=ga,m=b[c],e=d,e=a("<div />").css({position:"absolute",opacity:h.borderOpacity}).addClass(h.baseClass+"-"+e);F.append(e);g[m]=e}}function g(a){var d;for(d=0;d<a.length;d++){var c=s,f=a[d],e=h.handleSize,m=b(a[d],r++).css({opacity:h.handleOpacity}).addClass(h.baseClass+
"-handle");e&&m.width(e).height(e);c[f]=m}}function m(){var a=C.getFixed();C.setPressed([a.x,a.y]);C.setCurrent([a.x2,a.y2]);e()}function e(a){if(q)return k(a)}function k(a){var b=C.getFixed(),c=b.h;aa.width(Math.round(b.w)).height(Math.round(c));var c=b.x,f=b.y;h.shade||T.css({top:p(-f),left:p(-c)});aa.css({top:p(f),left:p(c)});h.shade&&W.updateRaw(b);q||(aa.show(),h.shade?W.opacity(ba):u(ba,!0),q=!0);a?h.onSelect.call(S,d(b)):h.onChange.call(S,d(b))}function u(a,b,d){if(q||b)h.bgFade&&!d?n.animate({opacity:a},
{queue:!1,duration:h.fadeTime}):n.css("opacity",a)}function x(){Q=!0;if(h.allowResize)return Z.show(),!0}function l(){Q=!1;Z.hide()}function H(a){a?(ia=!0,l()):(ia=!1,x())}var q,r=370,ga={},s={},Q=!1;h.dragEdges&&a.isArray(h.createDragbars)&&c(h.createDragbars);a.isArray(h.createHandles)&&g(h.createHandles);h.drawBorders&&a.isArray(h.createBorders)&&f(h.createBorders);a(document).bind("touchstart.jcrop-ios",function(b){a(b.currentTarget).hasClass("jcrop-tracker")&&b.stopPropagation()});var t=A().mousedown(z("move")).css({cursor:"move",
position:"absolute",zIndex:360});U.support&&t.bind("touchstart.jcrop",U.createDragger("move"));F.append(t);l();return{updateVisible:e,update:k,release:function(){l();aa.hide();h.shade?W.opacity(1):u(1);q=!1;h.onRelease.call(S)},refresh:m,isAwake:function(){return q},setCursor:function(a){t.css("cursor",a)},enableHandles:x,enableOnly:function(){Q=!0},showHandles:function(){Q&&Z.show()},disableHandles:l,animMode:H,setBgOpacity:u,done:function(){H(!1);m()}}}(),V=function(){function b(a){m(c(a));return!1}
function f(b){b.preventDefault();b.stopPropagation();Y&&(Y=!1,k(c(b)),w.isAwake()&&h.onSelect.call(S,d(C.getFixed())),X.css({zIndex:290}),a(document).unbind(".jcrop"),m=function(){},k=function(){});return!1}function g(a){m(c(U.cfilter(a)));return!1}function e(a){return f(U.cfilter(a))}var m=function(){},k=function(){},u=h.trackDocument;u||X.mousemove(b).mouseup(f).mouseout(f);n.before(X);return{activateHandlers:function(d,c,h){Y=!0;m=d;k=c;X.css({zIndex:450});h?a(document).bind("touchmove.jcrop",
g).bind("touchend.jcrop",e):u&&a(document).bind("mousemove.jcrop",b).bind("mouseup.jcrop",f);return!1},setCursor:function(a){X.css("cursor",a)}}}(),ha=function(){function b(a){f.hide()}function d(a,b,c){h.allowMove&&(C.moveOffset([b,c]),w.updateVisible(!0));a.preventDefault();a.stopPropagation()}function c(a){if(a.ctrlKey||a.metaKey)return!0;var b=(ka=a.shiftKey?!0:!1)?10:1;switch(a.keyCode){case 37:d(a,-b,0);break;case 39:d(a,b,0);break;case 38:d(a,0,-b);break;case 40:d(a,0,b);break;case 27:h.allowSelect&&
w.release();break;case 9:return!0}return!1}var f=a('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),g=a("<div />").css({position:"absolute",overflow:"hidden"}).append(f);h.keySupport&&(f.keydown(c).blur(b),B||!h.fixedSupport?(f.css({position:"absolute",left:"-20px"}),g.append(f).insertBefore(n)):f.insertBefore(n));return{watchKeys:function(){h.keySupport&&(f.show(),f.focus())}}}();U.support&&X.bind("touchstart.jcrop",U.newSelection);Z.hide();x(!0);
var S={setImage:function(a,b){w.release();M();var d=new Image;d.onload=function(){var c=d.height,f=h.boxWidth,g=h.boxHeight;n.width(d.width).height(c);n.attr("src",a);T.attr("src",a);y(n,f,g);q=n.width();r=n.height();T.width(q).height(r);X.width(q+2*Q).height(r+2*Q);J.width(q).height(r);W.resize(q,r);N();"function"===typeof b&&b.call(S)};d.src=a},animateTo:function(a,b){var d=a[0]/I,c=a[1]/K,f=a[2]/I,g=a[3]/K;if(!ia){var m=C.flipCoords(d,c,f,g),e=C.getFixed(),k=[e.x,e.y,e.x2,e.y2],u=h.animationDelay,
n=m[0]-k[0],F=m[1]-k[1],x=m[2]-k[2],l=m[3]-k[3],q=0,H=h.swingSpeed,d=k[0],c=k[1],f=k[2],g=k[3];w.animMode(!0);var p=function(){return function(){q+=(100-q)/H;k[0]=Math.round(d+q/100*n);k[1]=Math.round(c+q/100*F);k[2]=Math.round(f+q/100*x);k[3]=Math.round(g+q/100*l);99.8<=q&&(q=100);100>q?(E(k),window.setTimeout(p,u)):(w.done(),w.animMode(!1),"function"===typeof b&&b.call(S))}}();window.setTimeout(p,u)}},setSelect:D,setOptions:function(a){u(a);x()},tellSelect:function(){return d(C.getFixed())},tellScaled:function(){return C.getFixed()},
setClass:function(a){J.removeClass().addClass(h.baseClass+"-holder").addClass(a)},disable:M,enable:N,cancel:function(){w.done();V.activateHandlers(null,null)},release:w.release,destroy:function(){J.remove();s.show();s.css("visibility","visible");a(e).removeData("Jcrop")},focus:ha.watchKeys,getBounds:function(){return[q*I,r*K]},getWidgetSize:function(){return[q,r]},getScaleFactor:function(){return[I,K]},getOptions:function(){return h},ui:{holder:J,selection:aa}};R&&J.bind("selectstart",function(){return!1});
s.data("Jcrop",S);return S};a.fn.Jcrop=function(e,l){var p;this.each(function(){if(a(this).data("Jcrop")){if("api"===e)return a(this).data("Jcrop");a(this).data("Jcrop").setOptions(e)}else"IMG"==this.tagName?a.Jcrop.Loader(this,function(){a(this).css({display:"block",visibility:"hidden"});p=a.Jcrop(this,e);a.isFunction(l)&&l.call(p)}):(a(this).css({display:"block",visibility:"hidden"}),p=a.Jcrop(this,e),a.isFunction(l)&&l.call(p))});return this};a.Jcrop.Loader=function(e,l,p){function b(){u.complete?
(c.unbind(".jcloader"),a.isFunction(l)&&l.call(u)):window.setTimeout(b,50)}var c=a(e),u=c[0];c.bind("load.jcloader",b).bind("error.jcloader",function(b){c.unbind(".jcloader");a.isFunction(p)&&p.call(u)});u.complete&&a.isFunction(l)&&(c.unbind(".jcloader"),l.call(u))};a.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:0.6,bgFade:!1,borderOpacity:0.4,handleOpacity:0.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:"n s e w nw ne se sw".split(" "),
createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}})(jQuery);(function(a){var e,l,p={method:"GET",contentType:"json",queryParam:"q",searchDelay:300,minChars:1,propertyToSearch:"name",jsonContainer:null,hintText:"Type in a search term",noResultsText:"No results",searchingText:"Searching...",deleteText:"&times;",animateDropdown:!0,tokenLimit:null,tokenDelimiter:",",preventDuplicates:!1,tokenValue:"id",prePopulate:null,processPrePopulate:!1,idPrefix:"token-input-",resultsFormatter:function(a){return"<li>"+a[this.propertyToSearch]+"</li>"},tokenFormatter:function(a){return"<li><p>"+
a[this.propertyToSearch]+"</p></li>"},onResult:null,onAdd:null,onDelete:null,onReady:null},b={tokenList:"token-input-list",token:"token-input-token",tokenDelete:"token-input-delete-token",selectedToken:"token-input-selected-token",highlightedToken:"token-input-highlighted-token",dropdown:"token-input-dropdown",dropdownItem:"token-input-dropdown-item",dropdownItem2:"token-input-dropdown-item2",selectedDropdownItem:"token-input-selected-dropdown-item",inputToken:"token-input-input-token"};e=0;l=1;var c=
{init:function(b,c){var g=a.extend({},p,c||{});return this.each(function(){a(this).data("tokenInputObject",new a.TokenList(this,b,g))})},clear:function(){this.data("tokenInputObject").clear();return this},add:function(a){this.data("tokenInputObject").add(a);return this},remove:function(a){this.data("tokenInputObject").remove(a);return this},get:function(){return this.data("tokenInputObject").getTokens()}};a.fn.tokenInput=function(a){return c[a]?c[a].apply(this,Array.prototype.slice.call(arguments,
1)):c.init.apply(this,arguments)};a.TokenList=function(c,f,g){function k(){null!==g.tokenLimit&&h>=g.tokenLimit&&(B.hide(),t())}function p(b){var d=g.tokenFormatter(b),d=a(d).addClass(g.classes.token).insertBefore(r);a("<span>"+g.deleteText+"</span>").addClass(g.classes.tokenDelete).appendTo(d).click(function(){v(a(this).parent());s.change();return!1});var c={id:b.id};c[g.propertyToSearch]=b[g.propertyToSearch];a.data(d.get(0),"tokeninput",b);x=x.slice(0,H).concat([c]).concat(x.slice(H));H++;G(x,
s);h+=1;null!==g.tokenLimit&&h>=g.tokenLimit&&(B.hide(),t());return d}function z(b){var d=g.onAdd;if(0<h&&g.preventDuplicates){var c=null;q.children().each(function(){var d=a(this),f=a.data(d.get(0),"tokeninput");if(f&&f.id===b.id)return c=d,!1});if(c){y(c);r.insertAfter(c);B.focus();return}}if(null==g.tokenLimit||h<g.tokenLimit)p(b),k();B.val("");t();a.isFunction(d)&&d.call(s,b)}function y(a){a.addClass(g.classes.selectedToken);m=a.get(0);B.val("");t()}function d(a,b){a.removeClass(g.classes.selectedToken);
m=null;b===e?(r.insertBefore(a),H--):b===l?(r.insertAfter(a),H++):(r.appendTo(q),H=h);B.focus()}function v(b){var d=a.data(b.get(0),"tokeninput"),c=g.onDelete,f=b.prevAll().length;f>H&&f--;b.remove();m=null;B.focus();x=x.slice(0,f).concat(x.slice(f+1));f<H&&H--;G(x,s);h-=1;null!==g.tokenLimit&&B.show().val("").focus();a.isFunction(c)&&c.call(s,d)}function G(b,d){var c=a.map(b,function(a){return a[g.tokenValue]});d.val(c.join(g.tokenDelimiter))}function t(){J.hide().empty();n=null}function A(){J.css({position:"absolute",
top:a(q).offset().top+a(q).outerHeight(),left:a(q).offset().left,zindex:999}).show()}function D(b,d){if(d&&d.length){J.empty();var c=a("<ul>").appendTo(J).mouseover(function(b){E(a(b.target).closest("li"))}).mousedown(function(b){z(a(b.target).closest("li").data("tokeninput"));s.change();return!1}).hide();a.each(d,function(d,f){var m=g.resultsFormatter(f),m=m.replace(RegExp("(?![^&;]+;)(?!<[^<>]*)("+f[g.propertyToSearch]+")(?![^<>]*>)(?![^&;]+;)","g"),f[g.propertyToSearch].replace(RegExp("(?![^&;]+;)(?!<[^<>]*)("+
b+")(?![^<>]*>)(?![^&;]+;)","gi"),"<b>$1</b>")),m=a(m).appendTo(c);d%2?m.addClass(g.classes.dropdownItem):m.addClass(g.classes.dropdownItem2);0===d&&E(m);a.data(m.get(0),"tokeninput",f)});A();g.animateDropdown?c.slideDown("fast"):c.show()}else g.noResultsText&&(J.html("<p>"+g.noResultsText+"</p>"),A())}function E(b){b&&(n&&(a(n).removeClass(g.classes.selectedDropdownItem),n=null),b.addClass(g.classes.selectedDropdownItem),n=b.get(0))}function M(){var b=B.val().toLowerCase();b&&b.length&&(m&&d(a(m),
l),b.length>=g.minChars?(g.searchingText&&(J.html("<p>"+g.searchingText+"</p>"),A()),clearTimeout(O),O=setTimeout(function(){N(b)},g.searchDelay)):t())}function N(b){var d=b+P(),c=L.get(d);if(c)D(b,c);else if(g.url){var c=P(),f={data:{}};-1<c.indexOf("?")?(c=c.split("?"),f.url=c[0],c=c[1].split("&"),a.each(c,function(a,b){var d=b.split("=");f.data[d[0]]=d[1]})):f.url=c;f.data[g.queryParam]=b;f.type=g.method;f.dataType=g.contentType;g.crossDomain&&(f.dataType="jsonp");f.success=function(c){a.isFunction(g.onResult)&&
(c=g.onResult.call(s,c));L.add(d,g.jsonContainer?c[g.jsonContainer]:c);B.val().toLowerCase()===b&&D(b,g.jsonContainer?c[g.jsonContainer]:c)};a.ajax(f)}else g.local_data&&(c=a.grep(g.local_data,function(a){return-1<a[g.propertyToSearch].toLowerCase().indexOf(b.toLowerCase())}),a.isFunction(g.onResult)&&(c=g.onResult.call(s,c)),L.add(d,c),D(b,c))}function P(){var a=g.url;"function"==typeof g.url&&(a=g.url.call());return a}"string"===a.type(f)||"function"===a.type(f)?(g.url=f,f=P(),void 0===g.crossDomain&&
(-1===f.indexOf("://")?g.crossDomain=!1:g.crossDomain=location.href.split(/\/+/g)[1]!==f.split(/\/+/g)[1])):"object"===typeof f&&(g.local_data=f);g.classes?g.classes=a.extend({},b,g.classes):g.theme?(g.classes={},a.each(b,function(a,b){g.classes[a]=b+"-"+g.theme})):g.classes=b;var x=[],h=0,L=new a.TokenList.Cache,O,R,B=a('<input type="text"  autocomplete="off">').css({outline:"none"}).attr("id",g.idPrefix+c.id).focus(function(){if((null===g.tokenLimit||g.tokenLimit!==h)&&g.hintText)J.html("<p>"+g.hintText+
"</p>"),A()}).blur(function(){t();a(this).val("")}).bind("keyup keydown blur update",function(){if(R!==(R=B.val())){var a=R.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");T.html(a);B.width(T.width()+30)}}).keydown(function(b){var c,f;switch(b.keyCode){case 37:case 39:case 38:case 40:if(a(this).val())return c=null,c=40===b.keyCode||39===b.keyCode?a(n).next():a(n).prev(),c.length&&E(c),!1;c=r.prev();f=r.next();c.length&&c.get(0)===m||f.length&&f.get(0)===m?37===b.keyCode||
38===b.keyCode?d(a(m),e):d(a(m),l):(37===b.keyCode||38===b.keyCode)&&c.length?y(a(c.get(0))):(39===b.keyCode||40===b.keyCode)&&f.length&&y(a(f.get(0)));break;case 8:c=r.prev();if(a(this).val().length)1===a(this).val().length?t():setTimeout(function(){M()},5);else return m?(v(a(m)),s.change()):c.length&&y(a(c.get(0))),!1;break;case 9:case 13:case 108:case 188:if(n)return z(a(n).data("tokeninput")),s.change(),!1;break;case 27:return t(),!0;default:String.fromCharCode(b.which)&&setTimeout(function(){M()},
5)}}),s=a(c).hide().val("").focus(function(){B.focus()}).blur(function(){B.blur()}),m=null,H=0,n=null,q=a("<ul />").addClass(g.classes.tokenList).click(function(b){if((b=a(b.target).closest("li"))&&b.get(0)&&a.data(b.get(0),"tokeninput")){var c=m;m&&d(a(m),2);c===b.get(0)?d(b,2):y(b)}else m&&d(a(m),2),B.focus()}).mouseover(function(b){(b=a(b.target).closest("li"))&&m!==this&&b.addClass(g.classes.highlightedToken)}).mouseout(function(b){(b=a(b.target).closest("li"))&&m!==this&&b.removeClass(g.classes.highlightedToken)}).insertBefore(s),
r=a("<li />").addClass(g.classes.inputToken).appendTo(q).append(B),J=a("<div>").addClass(g.classes.dropdown).appendTo("body").hide(),T=a("<tester/>").insertAfter(B).css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:B.css("fontSize"),fontFamily:B.css("fontFamily"),fontWeight:B.css("fontWeight"),letterSpacing:B.css("letterSpacing"),whiteSpace:"nowrap"});s.val("");c=g.prePopulate||s.data("pre");g.processPrePopulate&&a.isFunction(g.onResult)&&(c=g.onResult.call(s,c));c&&c.length&&a.each(c,
function(a,b){p(b);k()});a.isFunction(g.onReady)&&g.onReady.call();this.clear=function(){q.children("li").each(function(){0===a(this).children("input").length&&v(a(this))})};this.add=function(a){z(a)};this.remove=function(b){q.children("li").each(function(){if(0===a(this).children("input").length){var c=a(this).data("tokeninput"),d=!0,f;for(f in b)if(b[f]!==c[f]){d=!1;break}d&&v(a(this))}})};this.getTokens=function(){return x}};a.TokenList.Cache=function(b){var c=a.extend({max_size:500},b),g={},e=
0;this.add=function(a,b){e>c.max_size&&(g={},e=0);g[a]||(e+=1);g[a]=b};this.get=function(a){return g[a]}}})(jQuery);(function(a){function e(b){var c=b||window.event,e=[].slice.call(arguments,1),f=0,g=0,k=0;b=a.event.fix(c);b.type="mousewheel";c.wheelDelta&&(f=c.wheelDelta/120);c.detail&&(f=-c.detail/3);k=f;void 0!==c.axis&&c.axis===c.HORIZONTAL_AXIS&&(k=0,g=-1*f);void 0!==c.wheelDeltaY&&(k=c.wheelDeltaY/120);void 0!==c.wheelDeltaX&&(g=-1*c.wheelDeltaX/120);e.unshift(b,f,g,k);return(a.event.dispatch||a.event.handle).apply(this,e)}var l=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var p=l.length;p;)a.event.fixHooks[l[--p]]=
a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=l.length;a;)this.addEventListener(l[--a],e,!1);else this.onmousewheel=e},teardown:function(){if(this.removeEventListener)for(var a=l.length;a;)this.removeEventListener(l[--a],e,!1);else this.onmousewheel=null}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(jQuery);(function(a){var e={init:function(b){b=a.extend(!0,{set_width:!1,set_height:!1,horizontalScroll:!1,scrollInertia:950,mouseWheel:!0,mouseWheelPixels:"auto",autoDraggerLength:!0,autoHideScrollbar:!1,alwaysShowScrollbar:!1,snapAmount:null,snapOffset:0,scrollButtons:{enable:!1,scrollType:"continuous",scrollSpeed:"auto",scrollAmount:40},advanced:{updateOnBrowserResize:!0,updateOnContentResize:!1,autoExpandHorizontalScroll:!1,autoScrollOnFocus:!0,normalizeMouseWheelDelta:!1},contentTouchScroll:!0,callbacks:{onScrollStart:function(){},
onScroll:function(){},onTotalScroll:function(){},onTotalScrollBack:function(){},onTotalScrollOffset:0,onTotalScrollBackOffset:0,whileScrolling:function(){}},theme:"light"},b);return this.each(function(){var c=a(this);b.set_width&&c.css("width",b.set_width);b.set_height&&c.css("height",b.set_height);if(a(document).data("mCustomScrollbar-index")){var e=parseInt(a(document).data("mCustomScrollbar-index"));a(document).data("mCustomScrollbar-index",e+1)}else a(document).data("mCustomScrollbar-index","1");
c.wrapInner("<div class='mCustomScrollBox mCS-"+b.theme+"' id='mCSB_"+a(document).data("mCustomScrollbar-index")+"' style='position:relative; height:100%; overflow:hidden; max-width:100%;' />").addClass("mCustomScrollbar _mCS_"+a(document).data("mCustomScrollbar-index"));var f=c.children(".mCustomScrollBox");b.horizontalScroll?(f.addClass("mCSB_horizontal").wrapInner("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />"),e=f.children(".mCSB_h_wrapper"),e.wrapInner("<div class='mCSB_container' style='position:absolute; left:0;' />").children(".mCSB_container").css({width:e.children().outerWidth(),
position:"relative"}).unwrap()):f.wrapInner("<div class='mCSB_container' style='position:relative; top:0;' />");var g=f.children(".mCSB_container");a.support.touch&&g.addClass("mCS_touch");g.after("<div class='mCSB_scrollTools' style='position:absolute;'><div class='mCSB_draggerContainer'><div class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' style='position:relative;'></div></div><div class='mCSB_draggerRail'></div></div></div>");var e=f.children(".mCSB_scrollTools"),
k=e.children(".mCSB_draggerContainer").children(".mCSB_dragger");b.horizontalScroll?k.data("minDraggerWidth",k.width()):k.data("minDraggerHeight",k.height());b.scrollButtons.enable&&(b.horizontalScroll?e.prepend("<a class='mCSB_buttonLeft' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonRight' oncontextmenu='return false;'></a>"):e.prepend("<a class='mCSB_buttonUp' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonDown' oncontextmenu='return false;'></a>"));f.bind("scroll",
function(){c.is(".mCS_disabled")||f.scrollTop(0).scrollLeft(0)});c.data({mCS_Init:!0,mCustomScrollbarIndex:a(document).data("mCustomScrollbar-index"),horizontalScroll:b.horizontalScroll,scrollInertia:b.scrollInertia,scrollEasing:"mcsEaseOut",mouseWheel:b.mouseWheel,mouseWheelPixels:b.mouseWheelPixels,autoDraggerLength:b.autoDraggerLength,autoHideScrollbar:b.autoHideScrollbar,alwaysShowScrollbar:b.alwaysShowScrollbar,snapAmount:b.snapAmount,snapOffset:b.snapOffset,scrollButtons_enable:b.scrollButtons.enable,
scrollButtons_scrollType:b.scrollButtons.scrollType,scrollButtons_scrollSpeed:b.scrollButtons.scrollSpeed,scrollButtons_scrollAmount:b.scrollButtons.scrollAmount,autoExpandHorizontalScroll:b.advanced.autoExpandHorizontalScroll,autoScrollOnFocus:b.advanced.autoScrollOnFocus,normalizeMouseWheelDelta:b.advanced.normalizeMouseWheelDelta,contentTouchScroll:b.contentTouchScroll,onScrollStart_Callback:b.callbacks.onScrollStart,onScroll_Callback:b.callbacks.onScroll,onTotalScroll_Callback:b.callbacks.onTotalScroll,
onTotalScrollBack_Callback:b.callbacks.onTotalScrollBack,onTotalScroll_Offset:b.callbacks.onTotalScrollOffset,onTotalScrollBack_Offset:b.callbacks.onTotalScrollBackOffset,whileScrolling_Callback:b.callbacks.whileScrolling,bindEvent_scrollbar_drag:!1,bindEvent_content_touch:!1,bindEvent_scrollbar_click:!1,bindEvent_mousewheel:!1,bindEvent_buttonsContinuous_y:!1,bindEvent_buttonsContinuous_x:!1,bindEvent_buttonsPixels_y:!1,bindEvent_buttonsPixels_x:!1,bindEvent_focusin:!1,bindEvent_autoHideScrollbar:!1,
mCSB_buttonScrollRight:!1,mCSB_buttonScrollLeft:!1,mCSB_buttonScrollDown:!1,mCSB_buttonScrollUp:!1});if(b.horizontalScroll)"none"!==c.css("max-width")&&!b.advanced.updateOnContentResize&&(b.advanced.updateOnContentResize=!0);else if("none"!==c.css("max-height")){var l=!1,e=parseInt(c.css("max-height"));0<=c.css("max-height").indexOf("%")&&(l=e,e=c.parent().height()*l/100);c.css("overflow","hidden");f.css("max-height",e)}c.mCustomScrollbar("update");if(b.advanced.updateOnBrowserResize){var p,y=a(window).width(),
d=a(window).height();a(window).bind("resize."+c.data("mCustomScrollbarIndex"),function(){p&&clearTimeout(p);p=setTimeout(function(){if(!c.is(".mCS_disabled")&&!c.is(".mCS_destroyed")){var b=a(window).width(),e=a(window).height();if(y!==b||d!==e)"none"!==c.css("max-height")&&l&&f.css("max-height",c.parent().height()*l/100),c.mCustomScrollbar("update"),y=b,d=e}},150)})}if(b.advanced.updateOnContentResize){var v=b.horizontalScroll?g.outerWidth():g.outerHeight();setInterval(function(){if(b.horizontalScroll){b.advanced.autoExpandHorizontalScroll&&
g.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:g.outerWidth(),position:"relative"}).unwrap();var a=g.outerWidth()}else a=g.outerHeight();a!=v&&(c.mCustomScrollbar("update"),v=a)},300)}})},update:function(){var b=a(this),c=b.children(".mCustomScrollBox"),e=c.children(".mCSB_container");e.removeClass("mCS_no_scrollbar");b.removeClass("mCS_disabled mCS_destroyed");c.scrollTop(0).scrollLeft(0);var f=c.children(".mCSB_scrollTools"),
g=f.children(".mCSB_draggerContainer"),k=g.children(".mCSB_dragger");if(b.data("horizontalScroll")){var l=f.children(".mCSB_buttonLeft"),p=f.children(".mCSB_buttonRight"),y=c.width();b.data("autoExpandHorizontalScroll")&&e.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:e.outerWidth(),position:"relative"}).unwrap();var d=e.outerWidth()}else var v=f.children(".mCSB_buttonUp"),G=f.children(".mCSB_buttonDown"),
t=c.height(),A=e.outerHeight();A>t&&!b.data("horizontalScroll")?(f.css("display","block"),y=g.height(),b.data("autoDraggerLength")&&(d=Math.round(t/A*y),f=k.data("minDraggerHeight"),d<=f?k.css({height:f}):d>=y-10?k.css({height:y-10}):k.css({height:d}),k.children(".mCSB_dragger_bar").css({"line-height":k.height()+"px"})),d=k.height(),b.data("scrollAmount",(A-t)/(y-d)).mCustomScrollbar("scrolling",c,e,g,k,v,G,l,p),c=Math.abs(e.position().top),b.mCustomScrollbar("scrollTo",c,{scrollInertia:0,trigger:"internal"})):
d>y&&b.data("horizontalScroll")?(f.css("display","block"),t=g.width(),b.data("autoDraggerLength")&&(A=Math.round(y/d*t),f=k.data("minDraggerWidth"),A<=f?k.css({width:f}):A>=t-10?k.css({width:t-10}):k.css({width:A})),A=k.width(),b.data("scrollAmount",(d-y)/(t-A)).mCustomScrollbar("scrolling",c,e,g,k,v,G,l,p),c=Math.abs(e.position().left),b.mCustomScrollbar("scrollTo",c,{scrollInertia:0,trigger:"internal"})):(c.unbind("mousewheel focusin"),b.data("horizontalScroll")?k.add(e).css("left",0):k.add(e).css("top",
0),b.data("alwaysShowScrollbar")?b.data("horizontalScroll")?b.data("horizontalScroll")&&k.css({width:g.width()}):k.css({height:g.height()}):(f.css("display","none"),e.addClass("mCS_no_scrollbar")),b.data({bindEvent_mousewheel:!1,bindEvent_focusin:!1}))},scrolling:function(b,c,e,f,g,k,p,z){function y(a,b,c,e){d.data("horizontalScroll")?d.mCustomScrollbar("scrollTo",f.position().left-b+e,{moveDragger:!0,trigger:"internal"}):d.mCustomScrollbar("scrollTo",f.position().top-a+c,{moveDragger:!0,trigger:"internal"})}
var d=a(this);if(!d.data("bindEvent_scrollbar_drag")){var v,G,t,A,D;a.support.pointer?(t="pointerdown",A="pointermove",D="pointerup"):a.support.msPointer&&(t="MSPointerDown",A="MSPointerMove",D="MSPointerUp");a.support.pointer||a.support.msPointer?(f.bind(t,function(b){b.preventDefault();d.data({on_drag:!0});f.addClass("mCSB_dragger_onDrag");var c=a(this),e=c.offset(),g=b.originalEvent.pageX-e.left;b=b.originalEvent.pageY-e.top;g<c.width()&&(0<g&&b<c.height()&&0<b)&&(v=b,G=g)}),a(document).bind(A+
"."+d.data("mCustomScrollbarIndex"),function(a){a.preventDefault();if(d.data("on_drag")){var b=f.offset();y(v,G,a.originalEvent.pageY-b.top,a.originalEvent.pageX-b.left)}}).bind(D+"."+d.data("mCustomScrollbarIndex"),function(a){d.data({on_drag:!1});f.removeClass("mCSB_dragger_onDrag")})):(f.bind("mousedown touchstart",function(b){b.preventDefault();b.stopImmediatePropagation();var c=a(this),e=c.offset(),g;"touchstart"===b.type?b=b.originalEvent.touches[0]||b.originalEvent.changedTouches[0]:(d.data({on_drag:!0}),
f.addClass("mCSB_dragger_onDrag"));g=b.pageX-e.left;e=b.pageY-e.top;g<c.width()&&(0<g&&e<c.height()&&0<e)&&(v=e,G=g)}).bind("touchmove",function(b){b.preventDefault();b.stopImmediatePropagation();b=b.originalEvent.touches[0]||b.originalEvent.changedTouches[0];var c=a(this).offset();y(v,G,b.pageY-c.top,b.pageX-c.left)}),a(document).bind("mousemove."+d.data("mCustomScrollbarIndex"),function(a){if(d.data("on_drag")){var b=f.offset();y(v,G,a.pageY-b.top,a.pageX-b.left)}}).bind("mouseup."+d.data("mCustomScrollbarIndex"),
function(a){d.data({on_drag:!1});f.removeClass("mCSB_dragger_onDrag")}));d.data({bindEvent_scrollbar_drag:!0})}if(a.support.touch&&d.data("contentTouchScroll")&&!d.data("bindEvent_content_touch")){var E,M,N,P,x,h,L;c.bind("touchstart",function(b){b.stopImmediatePropagation();E=b.originalEvent.touches[0]||b.originalEvent.changedTouches[0];M=a(this);N=M.offset();x=E.pageX-N.left;h=P=E.pageY-N.top;L=x});c.bind("touchmove",function(b){b.preventDefault();b.stopImmediatePropagation();E=b.originalEvent.touches[0]||
b.originalEvent.changedTouches[0];M=a(this).parent();N=M.offset();x=E.pageX-N.left;P=E.pageY-N.top;d.data("horizontalScroll")?d.mCustomScrollbar("scrollTo",L-x,{trigger:"internal"}):d.mCustomScrollbar("scrollTo",h-P,{trigger:"internal"})})}d.data("bindEvent_scrollbar_click")||(e.bind("click",function(b){var c=(b.pageY-e.offset().top)*d.data("scrollAmount"),f=a(b.target);d.data("horizontalScroll")&&(c=(b.pageX-e.offset().left)*d.data("scrollAmount"));(f.hasClass("mCSB_draggerContainer")||f.hasClass("mCSB_draggerRail"))&&
d.mCustomScrollbar("scrollTo",c,{trigger:"internal",scrollEasing:"draggerRailEase"})}),d.data({bindEvent_scrollbar_click:!0}));d.data("mouseWheel")&&!d.data("bindEvent_mousewheel")&&(b.bind("mousewheel",function(a,b){var g=d.data("mouseWheelPixels"),h=Math.abs(c.position().top),k=f.position().top,l=e.height()-f.height();d.data("normalizeMouseWheelDelta")&&(b=0>b?-1:1);"auto"===g&&(g=100+Math.round(d.data("scrollAmount")/2));d.data("horizontalScroll")&&(k=f.position().left,l=e.width()-f.width(),h=
Math.abs(c.position().left));if(0<b&&0!==k||0>b&&k!==l)a.preventDefault(),a.stopImmediatePropagation();d.mCustomScrollbar("scrollTo",h-b*g,{trigger:"internal"})}),d.data({bindEvent_mousewheel:!0}));if(d.data("scrollButtons_enable"))if("pixels"===d.data("scrollButtons_scrollType")){d.data("horizontalScroll")?(z.add(p).unbind("mousedown touchstart MSPointerDown pointerdown mouseup MSPointerUp pointerup mouseout MSPointerOut pointerout touchend",R,B),d.data({bindEvent_buttonsContinuous_x:!1}),d.data("bindEvent_buttonsPixels_x")||
(z.bind("click",function(a){a.preventDefault();O(Math.abs(c.position().left)+d.data("scrollButtons_scrollAmount"))}),p.bind("click",function(a){a.preventDefault();O(Math.abs(c.position().left)-d.data("scrollButtons_scrollAmount"))}),d.data({bindEvent_buttonsPixels_x:!0}))):(k.add(g).unbind("mousedown touchstart MSPointerDown pointerdown mouseup MSPointerUp pointerup mouseout MSPointerOut pointerout touchend",R,B),d.data({bindEvent_buttonsContinuous_y:!1}),d.data("bindEvent_buttonsPixels_y")||(k.bind("click",
function(a){a.preventDefault();O(Math.abs(c.position().top)+d.data("scrollButtons_scrollAmount"))}),g.bind("click",function(a){a.preventDefault();O(Math.abs(c.position().top)-d.data("scrollButtons_scrollAmount"))}),d.data({bindEvent_buttonsPixels_y:!0})));var O=function(a){f.data("preventAction")||(f.data("preventAction",!0),d.mCustomScrollbar("scrollTo",a,{trigger:"internal"}))}}else{if(d.data("horizontalScroll")){if(z.add(p).unbind("click"),d.data({bindEvent_buttonsPixels_x:!1}),!d.data("bindEvent_buttonsContinuous_x")){z.bind("mousedown touchstart MSPointerDown pointerdown",
function(a){a.preventDefault();var b=s();d.data({mCSB_buttonScrollRight:setInterval(function(){d.mCustomScrollbar("scrollTo",Math.abs(c.position().left)+b,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var R=function(a){a.preventDefault();clearInterval(d.data("mCSB_buttonScrollRight"))};z.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",R);p.bind("mousedown touchstart MSPointerDown pointerdown",function(a){a.preventDefault();var b=s();d.data({mCSB_buttonScrollLeft:setInterval(function(){d.mCustomScrollbar("scrollTo",
Math.abs(c.position().left)-b,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var B=function(a){a.preventDefault();clearInterval(d.data("mCSB_buttonScrollLeft"))};p.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",B);d.data({bindEvent_buttonsContinuous_x:!0})}}else k.add(g).unbind("click"),d.data({bindEvent_buttonsPixels_y:!1}),d.data("bindEvent_buttonsContinuous_y")||(k.bind("mousedown touchstart MSPointerDown pointerdown",function(a){a.preventDefault();var b=
s();d.data({mCSB_buttonScrollDown:setInterval(function(){d.mCustomScrollbar("scrollTo",Math.abs(c.position().top)+b,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})}),k.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",function(a){a.preventDefault();clearInterval(d.data("mCSB_buttonScrollDown"))}),g.bind("mousedown touchstart MSPointerDown pointerdown",function(a){a.preventDefault();var b=s();d.data({mCSB_buttonScrollUp:setInterval(function(){d.mCustomScrollbar("scrollTo",
Math.abs(c.position().top)-b,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})}),g.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",function(a){a.preventDefault();clearInterval(d.data("mCSB_buttonScrollUp"))}),d.data({bindEvent_buttonsContinuous_y:!0}));var s=function(){var a=d.data("scrollButtons_scrollSpeed");"auto"===d.data("scrollButtons_scrollSpeed")&&(a=Math.round((d.data("scrollInertia")+100)/40));return a}}d.data("autoScrollOnFocus")&&!d.data("bindEvent_focusin")&&
(b.bind("focusin",function(){b.scrollTop(0).scrollLeft(0);var f=a(document.activeElement);if(f.is("input,textarea,select,button,a[tabindex],area,object")){var e=c.position().top,g=f.position().top,h=b.height()-f.outerHeight();d.data("horizontalScroll")&&(e=c.position().left,g=f.position().left,h=b.width()-f.outerWidth());(0>e+g||e+g>h)&&d.mCustomScrollbar("scrollTo",g,{trigger:"internal"})}}),d.data({bindEvent_focusin:!0}));d.data("autoHideScrollbar")&&!d.data("alwaysShowScrollbar")&&!d.data("bindEvent_autoHideScrollbar")&&
(b.bind("mouseenter",function(a){b.addClass("mCS-mouse-over");l.showScrollbar.call(b.children(".mCSB_scrollTools"))}).bind("mouseleave touchend",function(a){b.removeClass("mCS-mouse-over");"mouseleave"===a.type&&l.hideScrollbar.call(b.children(".mCSB_scrollTools"))}),d.data({bindEvent_autoHideScrollbar:!0}))},scrollTo:function(b,c){function e(a){if(f.data("mCustomScrollbarIndex"))switch(this.mcs={top:z.position().top,left:z.position().left,draggerTop:v.position().top,draggerLeft:v.position().left,
topPct:Math.round(100*Math.abs(z.position().top)/Math.abs(z.outerHeight()-p.height())),leftPct:Math.round(100*Math.abs(z.position().left)/Math.abs(z.outerWidth()-p.width()))},a){case "onScrollStart":f.data("mCS_tweenRunning",!0).data("onScrollStart_Callback").call(f,this.mcs);break;case "whileScrolling":f.data("whileScrolling_Callback").call(f,this.mcs);break;case "onScroll":f.data("onScroll_Callback").call(f,this.mcs);break;case "onTotalScrollBack":f.data("onTotalScrollBack_Callback").call(f,this.mcs);
break;case "onTotalScroll":f.data("onTotalScroll_Callback").call(f,this.mcs)}}var f=a(this),g={moveDragger:!1,trigger:"external",callbacks:!0,scrollInertia:f.data("scrollInertia"),scrollEasing:f.data("scrollEasing")};c=a.extend(g,c);var k,p=f.children(".mCustomScrollBox"),z=p.children(".mCSB_container"),y=p.children(".mCSB_scrollTools"),d=y.children(".mCSB_draggerContainer"),v=d.children(".mCSB_dragger"),g=draggerSpeed=c.scrollInertia,G,t,A,D;if(!z.hasClass("mCS_no_scrollbar")&&(f.data({mCS_trigger:c.trigger}),
f.data("mCS_Init")&&(c.callbacks=!1),b||0===b))"number"===typeof b?c.moveDragger?(k=b,b=f.data("horizontalScroll")?v.position().left*f.data("scrollAmount"):v.position().top*f.data("scrollAmount"),draggerSpeed=0):k=b/f.data("scrollAmount"):"string"===typeof b&&(k="top"===b?0:"bottom"===b&&!f.data("horizontalScroll")?z.outerHeight()-p.height():"left"===b?0:"right"===b&&f.data("horizontalScroll")?z.outerWidth()-p.width():"first"===b?f.find(".mCSB_container").find(":first"):"last"===b?f.find(".mCSB_container").find(":last"):
f.find(b),1===k.length?(b=f.data("horizontalScroll")?k.position().left:k.position().top,k=b/f.data("scrollAmount")):k=b=k),f.data("horizontalScroll")?(f.data("onTotalScrollBack_Offset")&&(t=-f.data("onTotalScrollBack_Offset")),f.data("onTotalScroll_Offset")&&(D=p.width()-z.outerWidth()+f.data("onTotalScroll_Offset")),0>k?(k=b=0,clearInterval(f.data("mCSB_buttonScrollLeft")),t||(G=!0)):k>=d.width()-v.width()?(k=d.width()-v.width(),b=p.width()-z.outerWidth(),clearInterval(f.data("mCSB_buttonScrollRight")),
D||(A=!0)):b=-b,(d=f.data("snapAmount"))&&(b=Math.round(b/d)*d-f.data("snapOffset")),l.mTweenAxis.call(this,v[0],"left",Math.round(k),draggerSpeed,c.scrollEasing),l.mTweenAxis.call(this,z[0],"left",Math.round(b),g,c.scrollEasing,{onStart:function(){c.callbacks&&!f.data("mCS_tweenRunning")&&e("onScrollStart");f.data("autoHideScrollbar")&&!f.data("alwaysShowScrollbar")&&l.showScrollbar.call(y)},onUpdate:function(){c.callbacks&&e("whileScrolling")},onComplete:function(){c.callbacks&&(e("onScroll"),(G||
t&&z.position().left>=t)&&e("onTotalScrollBack"),(A||D&&z.position().left<=D)&&e("onTotalScroll"));v.data("preventAction",!1);f.data("mCS_tweenRunning",!1);f.data("autoHideScrollbar")&&!f.data("alwaysShowScrollbar")&&(p.hasClass("mCS-mouse-over")||l.hideScrollbar.call(y))}})):(f.data("onTotalScrollBack_Offset")&&(t=-f.data("onTotalScrollBack_Offset")),f.data("onTotalScroll_Offset")&&(D=p.height()-z.outerHeight()+f.data("onTotalScroll_Offset")),0>k?(k=b=0,clearInterval(f.data("mCSB_buttonScrollUp")),
t||(G=!0)):k>=d.height()-v.height()?(k=d.height()-v.height(),b=p.height()-z.outerHeight(),clearInterval(f.data("mCSB_buttonScrollDown")),D||(A=!0)):b=-b,(d=f.data("snapAmount"))&&(b=Math.round(b/d)*d-f.data("snapOffset")),l.mTweenAxis.call(this,v[0],"top",Math.round(k),draggerSpeed,c.scrollEasing),l.mTweenAxis.call(this,z[0],"top",Math.round(b),g,c.scrollEasing,{onStart:function(){c.callbacks&&!f.data("mCS_tweenRunning")&&e("onScrollStart");f.data("autoHideScrollbar")&&!f.data("alwaysShowScrollbar")&&
l.showScrollbar.call(y)},onUpdate:function(){c.callbacks&&e("whileScrolling")},onComplete:function(){c.callbacks&&(e("onScroll"),(G||t&&z.position().top>=t)&&e("onTotalScrollBack"),(A||D&&z.position().top<=D)&&e("onTotalScroll"));v.data("preventAction",!1);f.data("mCS_tweenRunning",!1);f.data("autoHideScrollbar")&&!f.data("alwaysShowScrollbar")&&(p.hasClass("mCS-mouse-over")||l.hideScrollbar.call(y))}})),f.data("mCS_Init")&&f.data({mCS_Init:!1})},stop:function(){var b=a(this),c=b.children().children(".mCSB_container"),
b=b.children().children().children().children(".mCSB_dragger");l.mTweenAxisStop.call(this,c[0]);l.mTweenAxisStop.call(this,b[0])},disable:function(b){var c=a(this),e=c.children(".mCustomScrollBox"),f=e.children(".mCSB_container"),g=e.children(".mCSB_scrollTools"),k=g.children().children(".mCSB_dragger");e.unbind("mousewheel focusin mouseenter mouseleave touchend");f.unbind("touchstart touchmove");b&&(c.data("horizontalScroll")?k.add(f).css("left",0):k.add(f).css("top",0));g.css("display","none");
f.addClass("mCS_no_scrollbar");c.data({bindEvent_mousewheel:!1,bindEvent_focusin:!1,bindEvent_content_touch:!1,bindEvent_autoHideScrollbar:!1}).addClass("mCS_disabled")},destroy:function(){var b=a(this);b.removeClass("mCustomScrollbar _mCS_"+b.data("mCustomScrollbarIndex")).addClass("mCS_destroyed").children().children(".mCSB_container").unwrap().children().unwrap().siblings(".mCSB_scrollTools").remove();a(document).unbind("mousemove."+b.data("mCustomScrollbarIndex")+" mouseup."+b.data("mCustomScrollbarIndex")+
" MSPointerMove."+b.data("mCustomScrollbarIndex")+" MSPointerUp."+b.data("mCustomScrollbarIndex"));a(window).unbind("resize."+b.data("mCustomScrollbarIndex"))}},l={showScrollbar:function(){this.stop().animate({opacity:1},"fast")},hideScrollbar:function(){this.stop().animate({opacity:0},"fast")},mTweenAxis:function(a,c,e,f,g,k){function l(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?
Date.now():(new Date).getTime()}function p(){E||v.call();E=l()-A;y();E>=a._time&&(a._time=E>a._time?E+D-(E-a._time):E+D-1,a._time<E+1&&(a._time=E+1));a._time<f?a._id=_request(p):t.call()}function y(){0<f?(a.currVal=d(a._time,M,P,f,g),N[c]=Math.round(a.currVal)+"px"):N[c]=e+"px";G.call()}function d(a,b,c,d,e){switch(e){case "linear":return c*a/d+b;case "easeOutQuad":return a/=d,-c*a*(a-2)+b;case "easeInOutQuad":a/=d/2;if(1>a)return c/2*a*a+b;a--;return-c/2*(a*(a-2)-1)+b;case "easeOutCubic":return a/=
d,a--,c*(a*a*a+1)+b;case "easeOutQuart":return a/=d,a--,-c*(a*a*a*a-1)+b;case "easeOutQuint":return a/=d,a--,c*(a*a*a*a*a+1)+b;case "easeOutCirc":return a/=d,a--,c*Math.sqrt(1-a*a)+b;case "easeOutSine":return c*Math.sin(a/d*(Math.PI/2))+b;case "easeOutExpo":return c*(-Math.pow(2,-10*a/d)+1)+b;case "mcsEaseOut":return d=(a/=d)*a,e=d*a,b+c*(0.499999999999997*e*d+-2.5*d*d+5.5*e+-6.5*d+4*a);case "draggerRailEase":a/=d/2;if(1>a)return c/2*a*a*a+b;a-=2;return c/2*(a*a*a+2)+b}}k=k||{};var v=k.onStart||function(){},
G=k.onUpdate||function(){},t=k.onComplete||function(){},A=l(),D,E=0,M=a.offsetTop,N=a.style;"left"===c&&(M=a.offsetLeft);var P=e-M;null!=a._id&&(window.requestAnimationFrame?window.cancelAnimationFrame(a._id):clearTimeout(a._id),a._id=null);(function(){D=1E3/60;a._time=E+D;_request=!window.requestAnimationFrame?function(a){y();return setTimeout(a,0.01)}:window.requestAnimationFrame;a._id=_request(p)})()},mTweenAxisStop:function(a){null!=a._id&&(window.requestAnimationFrame?window.cancelAnimationFrame(a._id):
clearTimeout(a._id),a._id=null)},rafPolyfill:function(){for(var a=["ms","moz","webkit","o"],c=a.length;-1<--c&&!window.requestAnimationFrame;)window.requestAnimationFrame=window[a[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[a[c]+"CancelAnimationFrame"]||window[a[c]+"CancelRequestAnimationFrame"]}};l.rafPolyfill.call();a.support.touch=!!("ontouchstart"in window);a.support.pointer=window.navigator.pointerEnabled;a.support.msPointer=window.navigator.msPointerEnabled;var p="https:"==
document.location.protocol?"https:":"http:";a.event.special.mousewheel||document.write('<script src="'+p+'//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.0.6/jquery.mousewheel.min.js">\x3c/script>');a.fn.mCustomScrollbar=function(b){if(e[b])return e[b].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof b||!b)return e.init.apply(this,arguments);a.error("Method "+b+" does not exist")}})(jQuery);$(document).on("click",".ss-link",function(){window.location.href=this.getAttribute("data-ss-link")});$(document).on("click",".header-settings-icon",function(){$(".header-settings-extended").animate({height:"toggle"})});$(document).on("click",".add-friend-button",function(){var a=this.getAttribute("data-uid");$(this).hide();$.ajax({url:"/ajax/user/send_friend_request",method:"POST",data:{id:a}}).done(function(a){})});
$.fn.text_multiline=function(a){this.text(a);this.html(this.html().replace(/\n/g,"<br/>"));return this};function dateToString(a){var e=a.getDate(),l="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a.getMonth()],p=a.getFullYear(),b=a.getHours();a=a.getMinutes();var c="AM";12<=b&&(b-=12,c="PM");0==b&&(b=12);return""+l+" "+(9>=e?"0"+e:e)+", "+p+" at "+(9>=b?"0"+b:b)+":"+(9>=a?"0"+a:a)+" "+c}
function convert_time(){$(".time-ago").each(function(){if(""==this.getAttribute("data-time"))return!0;var a=new Date(1E3*this.getAttribute("data-time")),e=Math.round((new Date-a)/1E3);0>e?(e=0-e,60>e?$(this).html("in a few seconds"):(e=Math.floor(e/60),10>e?$(this).html("in about "+e+" minutes"):$(this).html(dateToString(a)))):60>e?$(this).html("a few seconds ago"):(e=Math.floor(e/60),60>e?$(this).html("about "+e+" minute"+(1<e?"s":"")+" ago"):(e=Math.floor(e/60),24>e?$(this).html("about "+e+" hours ago"):
$(this).html(dateToString(a))))})}convert_time();var convert_time_internval=setInterval(convert_time,6E4);$(document).on("click",".page-tab",function(){var a=".page-tab-"+this.getAttribute("data-ss-tab");$(".page-tab").removeClass("is-active");$(this).addClass("is-active");$(".page-tab-component").hide();$(a).show()});$(document).on("click",".ss-photo",function(){console.log("--Expand photo")});
$(document).on("change",".ss-picture-upload",function(){var a=this;if(a.files&&a.files[0]){var e=a.files[0];if(!e.type.match(/image.*/))return!1;var l=new FileReader;l.onload=function(e){var b=$(a).parents(".ss-file-wrapper").siblings(".ss-picture-preview");e=$("<img/>").attr("src",e.target.result);b.html(e).show();e.Jcrop({aspectRatio:1,minSize:[50,50],setSelect:[100,100,50,50],onSelect:function(a){$('input[name="profile_x"]').val(a.x);$('input[name="profile_y"]').val(a.y);$('input[name="profile_w"]').val(a.w);
$('input[name="profile_h"]').val(a.h)}})};l.readAsDataURL(e)}});$(document).on("click",".thumb-up",function(){var a=$(this).children(".thumb-up-count"),e=$(this).siblings(".thumb-down").children(".thumb-down-count"),l=this.getAttribute("data-pid");$.ajax({url:"/ajax/post/save_thumb",method:"POST",data:{type:"up",id:l}}).done(function(l){0==l.result?(e.text(parseInt(e.text())-1),a.text(parseInt(a.text())+1)):1==l.result&&a.text(parseInt(a.text())+1)})});
$(document).on("click",".thumb-down",function(){var a=$(this).children(".thumb-down-count"),e=$(this).siblings(".thumb-up").children(".thumb-up-count"),l=this.getAttribute("data-pid");$.ajax({url:"/ajax/post/save_thumb",method:"POST",data:{type:"down",id:l}}).done(function(l){0==l.result?(a.text(parseInt(a.text())+1),e.text(parseInt(e.text())-1)):1==l.result&&a.text(parseInt(a.text())+1)})});$(document).on("change",'[name="user_photos[]"]',function(){var a=new FormData;for(i=0;i<this.files.length;i++)a.append("user_photos[]",this.files[i]);$.ajax({url:"/ajax/user/upload_photos",type:"POST",data:a,processData:!1,contentType:!1,dataType:"json"}).done(function(a){console.log(a)})});
$(document).on("mouseenter",".ss-photo",function(){$(this).children(".ss-photo-hover").fadeIn();$(this).children(".ss-photo-delete").fadeIn()}).on("mouseleave",".ss-photo",function(){$(this).children(".ss-photo-hover").fadeOut();$(this).children(".ss-photo-delete").fadeOut()});$(document).on("click",".ss-photo-delete",function(a){a.stopPropagation();a=this.getAttribute("data-ss-photo-id");$.ajax({url:"/ajax/user/delete_photo",type:"POST",data:{id:a}}).done(function(a){console.log(a)})});$("#right-calendar").datepicker();
$(".ss-search-anything").autocomplete({minLength:1,source:function(a,e){$.ajax({url:"/ajax/search",data:{search:a.term},dataType:"json",type:"GET",success:function(a){e(a)}})},select:function(a,e){a.preventDefault();window.location.href="/"+e.item.type.toLowerCase()+"/"+e.item.id}}).data("ui-autocomplete")._renderItem=function(a,e){var l='<a class="ss-search-result">';""!=e.profile_picture&&(l+='<div class="profile-picture ss-search-result-img"><img src="'+e.profile_picture+'" width="50" /></div>');
l+='<div class="ss-search-result-content">'+e.name+'<br /><span style="font-size: 12px;">'+e.data+"</span></div>";l+='<div class="clear"></div></a>';return $("<li>").append(l).appendTo(a)};$(".classroom-autocomplete").autocomplete({minLength:1,source:function(a,e){$.ajax({url:"/ajax/classroom/json",data:{search:a.term},dataType:"json",type:"GET",success:function(a){e(a)}})},select:function(a,e){a.preventDefault();window.location.href="/classroom/"+e.item.id}});for(i=0;i<$(".classroom-autocomplete").length;i++)$($(".classroom-autocomplete")[i]).data("ui-autocomplete")._renderItem=function(a,e){return $("<li>").append("<a>"+e.name+"</a>").appendTo(a)};
$(".group-autocomplete").autocomplete({minLength:1,source:function(a,e){$.ajax({url:"/ajax/group/json",data:{search:a.term},dataType:"json",type:"GET",success:function(a){e(a)}})},select:function(a,e){a.preventDefault();window.location.href="/group/"+e.item.id}});for(i=0;i<$(".group-autocomplete").length;i++)$($(".group-autocomplete")[i]).data("ui-autocomplete")._renderItem=function(a,e){return $("<li>").append("<a>"+e.name+"</a>").appendTo(a)};
$(".create-classroom").click(function(){window.location.href="/classroom/create?name="+encodeURIComponent($(".classroom-autocomplete").val())});$(".create-group").click(function(){window.location.href="/group/create?name="+encodeURIComponent($(".group-autocomplete").val())});$(".page-settings").on("click",".ss-delete",function(){var a=this.getAttribute("data-ss-id");$.ajax({url:"/ajax/settings/delete_education",type:"POST",data:{id:a}}).done(function(a){});$(this).parents("tr").remove()});$(".page-settings").on("click",".ss-add-education",function(){var a=$(".hide.snippet-add-education").clone().removeClass("hide"),a=$("<tr></tr>").append($("<td></td>").append(a));$(".ss-table-education").prepend(a);update_autocomplete_my_profile()});
$(".page-settings").on("change",'select[name="type[]"]',function(){var a=$(this).siblings('input[name="name[]"]');a.val("");a.removeClass("university-autocomplete");a.removeClass("highschool-autocomplete");"highschool"==this.value?a.addClass("highschool-autocomplete"):a.addClass("university-autocomplete");$(this).siblings('input[name="education_id[]"]').val("0");update_autocomplete_my_profile()});
function update_autocomplete_my_profile(){$(".highschool-autocomplete").autocomplete({minLength:1,source:function(a,e){$.ajax({url:"/ajax/highschool/json",data:{search:a.term},dataType:"json",type:"GET",success:function(a){e(a)}})},select:function(a,e){a.preventDefault();$(this).val(e.item.name);$(this).siblings('input[name="education_id[]"]').val(e.item.id)}});for(i=0;i<$(".highschool-autocomplete").length;i++)$($(".highschool-autocomplete")[i]).data("ui-autocomplete")._renderItem=function(a,e){return $("<li>").append("<a>"+
e.name+'<br /><span style="font-size: 12px;">'+e.address+"</span></a>").appendTo(a)};$(".university-autocomplete").autocomplete({minLength:1,source:function(a,e){$.ajax({url:"/ajax/university/json",data:{search:a.term},dataType:"json",type:"GET",success:function(a){e(a)}})},select:function(a,e){a.preventDefault();$(this).val(e.item.name);$(this).siblings('input[name="education_id[]"]').val(e.item.id)}});for(i=0;i<$(".university-autocomplete").length;i++)$($(".university-autocomplete")[i]).data("ui-autocomplete")._renderItem=
function(a,e){return $("<li>").append("<a>"+e.name+'<br /><span style="font-size: 12px;">'+e.address+"</span></a>").appendTo(a)};$(".major-autocomplete").autocomplete({minLength:1,source:function(a,e){$.ajax({url:"/ajax/major/json",data:{search:a.term},dataType:"json",type:"GET",success:function(a){e(a)}})},select:function(a,e){a.preventDefault();$(this).val(e.item.title);$(this).siblings('input[name="major_id[]"]').val(e.item.id)}});for(i=0;i<$(".major-autocomplete").length;i++)$($(".major-autocomplete")[i]).data("ui-autocomplete")._renderItem=
function(a,e){return $("<li>").append("<a>"+e.title+"</a>").appendTo(a)}};$(document).on("click",".join-cg",function(){var a=this.getAttribute("data-what"),a="/ajax/"+a+"/join",e=this.getAttribute("data-id");$(this).hide();$.ajax({url:a,type:"POST",data:{id:e}}).done(function(a){$("h2.count-members").text(parseInt($("h2.count-members").text())+1)})});$(window).resize(function(){var a=$(window).height()-200;$(".layout-sidebar-right .ss-container").height()>=a&&(a=$(".layout-sidebar-right .ss-container").height());$(".message-container-left").height(a);$(".message-container-main").height(a-100)});$(window).load(function(){$(window).resize();$(".message-container-main, .message-container-left").mCustomScrollbar();$(".layout-main .message-container-main").mCustomScrollbar("scrollTo","bottom")});
$(".layout-sidebar.message-page").on("click",".conversation-item",function(){var a=this.getAttribute("data-uid");$(".conversation-item").removeClass("is-selected");$(this).addClass("is-selected");$(".message-container-main .mCSB_container").html("");$(".message-send")[0].setAttribute("data-uid",a);$.ajax({url:"/ajax/messages/get_conversation",type:"GET",data:{uid:a}}).done(function(a){$.each(a,function(a,e){var b=$(".snippet-message").clone().removeClass("snippet-message");b.addClass(e.type+"-message");
$(".message-content p",b).text_multiline(e.message);$(".message-time",b)[0].setAttribute("data-time",e.created_at);$(".message-picture img",b)[0].setAttribute("src",e.message_picture);$(".message-container-main .mCSB_container").append(b);b.removeClass("hide")});convert_time();$(".layout-main .message-container-main").mCustomScrollbar("update");$(".layout-main .message-container-main").mCustomScrollbar("scrollTo","bottom")})});
$(".layout-main.message-page").on("click",".message-send",function(){var a=$(".message-new textarea"),e=$(this)[0].getAttribute("data-uid");a.val($.trim(a.val()));if(""!=a.val()){var l=$(".snippet-message").clone().removeClass("snippet-message");l.addClass("sent-message");$(".message-content p",l).text_multiline(a.val());$(".message-time",l)[0].setAttribute("data-time",Math.round(new Date/1E3));$(".message-container-main .mCSB_container").append(l);l.removeClass("hide");convert_time();$(".layout-main .message-container-main").mCustomScrollbar("update");
$(".layout-main .message-container-main").mCustomScrollbar("scrollTo","bottom");$.ajax({url:"/ajax/messages/send_message",type:"POST",data:{message:a.val(),uid:e}}).done(function(a){});a.val("")}});
