(function(a){a.Jcrop=function(c,h){function p(a){return Math.round(a)+"px"}function b(b){b=a(b).offset();return[b.left,b.top]}function l(a){return[a.pageX-M[0],a.pageY-M[1]]}function y(b){"object"!==typeof b&&(b={});g=a.extend(g,b);a.each(["onChange","onSelect","onRelease","onDblClick"],function(a,b){"function"!==typeof g[b]&&(g[b]=function(){})})}function e(a,g,e){M=b(m);W.setCursor("move"===a?a:a+"-resize");if("move"===a)return W.activateHandlers(k(g),v,e);g=C.getFixed();var c=F(a),f=C.getCorner(F(c));
C.setPressed(C.getCorner(c));C.setCurrent(f);W.activateHandlers(d(a,g),v,e)}function d(a,b){return function(e){if(g.aspectRatio)switch(a){case "e":e[1]=b.y+1;break;case "w":e[1]=b.y+1;break;case "n":e[0]=b.x+1;break;case "s":e[0]=b.x+1}else switch(a){case "e":e[1]=b.y2;break;case "w":e[1]=b.y2;break;case "n":e[0]=b.x2;break;case "s":e[0]=b.x2}C.setCurrent(e);w.update()}}function k(a){var b=a;ha.watchKeys();return function(a){C.moveOffset([a[0]-b[0],a[1]-b[1]]);b=a;w.update()}}function F(a){switch(a){case "n":return"sw";
case "s":return"nw";case "e":return"nw";case "w":return"ne";case "ne":return"sw";case "nw":return"se";case "se":return"nw";case "sw":return"ne"}}function r(a){return function(c){if(g.disabled||"move"===a&&!g.allowMove)return!1;M=b(m);Z=!0;e(a,l(c));c.stopPropagation();c.preventDefault();return!1}}function x(a,b,g){var e=a.width(),c=a.height();e>b&&0<b&&(e=b,c=b/a.width()*a.height());c>g&&0<g&&(c=g,e=g/a.height()*a.width());J=a.width()/e;L=a.height()/c;a.width(e).height(c)}function f(a){return{x:a.x*
J,y:a.y*L,x2:a.x2*J,y2:a.y2*L,w:a.w*J,h:a.h*L}}function v(a){a=C.getFixed();a.w>g.minSelect[0]&&a.h>g.minSelect[1]?(w.enableHandles(),w.done()):w.release();W.setCursor(g.allowSelect?"crosshair":"default")}function G(a){if(g.disabled||!g.allowSelect)return!1;Z=!0;M=b(m);w.disableHandles();W.setCursor("crosshair");var e=l(a);C.setPressed(e);w.update();W.activateHandlers(u,v,"touch"===a.type.substring(0,5));ha.watchKeys();a.stopPropagation();a.preventDefault();return!1}function u(a){C.setCurrent(a);
w.update()}function A(){var b=a("<div></div>").addClass(g.baseClass+"-tracker");S&&b.css({opacity:0,backgroundColor:"white"});return b}function D(a){E([a[0]/J,a[1]/L,a[2]/J,a[3]/L]);g.onSelect.call(T,f(C.getFixed()));w.enableHandles()}function E(a){C.setPressed([a[0],a[1]]);C.setCurrent([a[2],a[3]]);w.update()}function N(){g.disabled=!0;w.disableHandles();w.setCursor("default");W.setCursor("default")}function O(){g.disabled=!1;z()}function Q(b,e,c){e=e||g.bgColor;g.bgFade&&a.fx.step.hasOwnProperty("backgroundColor")&&
g.fadeTime&&!c?b.animate({backgroundColor:e},{queue:!1,duration:g.fadeTime}):b.css("backgroundColor",e)}function z(a){g.allowResize?a?w.enableOnly():w.enableHandles():w.disableHandles();W.setCursor(g.allowSelect?"crosshair":"default");w.setCursor(g.allowMove?"move":"default");g.hasOwnProperty("trueSize")&&(J=g.trueSize[0]/q,L=g.trueSize[1]/s);g.hasOwnProperty("setSelect")&&(D(g.setSelect),w.done(),delete g.setSelect);X.refresh();g.bgColor!=ja&&(Q(g.shade?X.getShades():K,g.shade?g.shadeColor||g.bgColor:
g.bgColor),ja=g.bgColor);ca!=g.bgOpacity&&(ca=g.bgOpacity,g.shade?X.refresh():w.setBgOpacity(ca));da=g.maxSize[0]||0;ea=g.maxSize[1]||0;fa=g.minSize[0]||0;ga=g.minSize[1]||0;g.hasOwnProperty("outerImage")&&(m.attr("src",g.outerImage),delete g.outerImage);w.refresh()}var g=a.extend({},a.Jcrop.defaults),M,P=navigator.userAgent.toLowerCase(),S=/msie/.test(P),B=/msie [1-6]\./.test(P);"object"!==typeof c&&(c=a(c)[0]);"object"!==typeof h&&(h={});y(h);var P={border:"none",visibility:"visible",margin:0,padding:0,
position:"absolute",top:0,left:0},t=a(c),n=!0;if("IMG"==c.tagName){if(0!=t[0].width&&0!=t[0].height)t.width(t[0].width),t.height(t[0].height);else{var H=new Image;H.src=t[0].src;t.width(H.width);t.height(H.height)}var m=t.clone().removeAttr("id").css(P).show();m.width(t.width());m.height(t.height());t.after(m).hide()}else m=t.css(P).show(),n=!1,null===g.shade&&(g.shade=!0);x(m,g.boxWidth,g.boxHeight);var q=m.width(),s=m.height(),K=a("<div />").width(q).height(s).addClass(g.baseClass+"-holder").css({position:"relative",
backgroundColor:g.bgColor}).insertAfter(t).append(m);g.addClass&&K.addClass(g.addClass);var U=a("<div />"),I=a("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),aa=a("<div />").width("100%").height("100%").css("zIndex",320),ba=a("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var a=C.getFixed();g.onDblClick.call(T,a)}).insertBefore(m).append(I,aa);n&&(U=a("<img />").attr("src",m.attr("src")).css(P).width(q).height(s),I.append(U));
B&&ba.css({overflowY:"hidden"});var R=g.boundary,Y=A().width(q+2*R).height(s+2*R).css({position:"absolute",top:p(-R),left:p(-R),zIndex:290}).mousedown(G),ja=g.bgColor,ca=g.bgOpacity,da,ea,fa,ga,J,L,Z,ia,ka;M=b(m);var V=function(){function a(){var b={},e=["touchstart","touchmove","touchend"],g=document.createElement("div"),c;try{for(c=0;c<e.length;c++){var d=e[c],d="on"+d,f=d in g;f||(g.setAttribute(d,"return;"),f="function"==typeof g[d]);b[e[c]]=f}return b.touchstart&&b.touchend&&b.touchmove}catch(l){return!1}}
var c;c=!0===g.touchSupport||!1===g.touchSupport?g.touchSupport:a();return{createDragger:function(a){return function(c){if(g.disabled||"move"===a&&!g.allowMove)return!1;M=b(m);Z=!0;e(a,l(V.cfilter(c)),!0);c.stopPropagation();c.preventDefault();return!1}},newSelection:function(a){return G(V.cfilter(a))},cfilter:function(a){a.pageX=a.originalEvent.changedTouches[0].pageX;a.pageY=a.originalEvent.changedTouches[0].pageY;return a},isSupported:a,support:c}}(),C=function(){function a(){if(!g.aspectRatio){var b=
l-d,h=n-f;da&&Math.abs(b)>da&&(l=0<b?d+da:d-da);ea&&Math.abs(h)>ea&&(n=0<h?f+ea:f-ea);ga/L&&Math.abs(h)<ga/L&&(n=0<h?f+ga/L:f-ga/L);fa/J&&Math.abs(b)<fa/J&&(l=0<b?d+fa/J:d-fa/J);0>d&&(l-=d,d-=d);0>f&&(n-=f,f-=f);0>l&&(d-=l,l-=l);0>n&&(f-=n,n-=n);l>q&&(b=l-q,d-=b,l-=b);n>s&&(b=n-s,f-=b,n-=b);d>q&&(b=d-s,n-=b,f-=b);f>s&&(b=f-s,n-=b,f-=b);return c(e(d,f,l,n))}var b=g.aspectRatio,h=g.minSize[0]/J,y=g.maxSize[0]/J,I=l-d,z=n-f,k=Math.abs(I),m=Math.abs(z);0===y&&(y=10*q);k/m<b?(k=n,m*=b,m=0>I?d-m:m+d,0>
m?(m=0,k=Math.abs((m-d)/b),k=0>z?f-k:k+f):m>q&&(m=q,k=Math.abs((m-d)/b),k=0>z?f-k:k+f)):(m=l,k/=b,k=0>z?f-k:f+k,0>k?(k=0,m=Math.abs((k-f)*b),m=0>I?d-m:m+d):k>s&&(k=s,m=Math.abs(k-f)*b,m=0>I?d-m:m+d));m>d?(m-d<h?m=d+h:m-d>y&&(m=d+y),k=k>f?f+(m-d)/b:f-(m-d)/b):m<d&&(d-m<h?m=d-h:d-m>y&&(m=d-y),k=k>f?f+(d-m)/b:f-(d-m)/b);0>m?(d-=m,m=0):m>q&&(d-=m-q,m=q);0>k?(f-=k,k=0):k>s&&(f-=k-s,k=s);return c(e(d,f,m,k))}function b(a){0>a[0]&&(a[0]=0);0>a[1]&&(a[1]=0);a[0]>q&&(a[0]=q);a[1]>s&&(a[1]=s);return[Math.round(a[0]),
Math.round(a[1])]}function e(a,b,d,f){var c=a,g=d,l=b,n=f;d<a&&(c=d,g=a);f<b&&(l=f,n=b);return[c,l,g,n]}function c(a){return{x:a[0],y:a[1],x2:a[2],y2:a[3],w:a[2]-a[0],h:a[3]-a[1]}}var d=0,f=0,l=0,n=0,h,y;return{flipCoords:e,setPressed:function(a){a=b(a);l=d=a[0];n=f=a[1]},setCurrent:function(a){a=b(a);h=a[0]-l;y=a[1]-n;l=a[0];n=a[1]},getOffset:function(){return[h,y]},moveOffset:function(a){var b=a[0];a=a[1];0>d+b&&(b-=b+d);0>f+a&&(a-=a+f);s<n+a&&(a+=s-(n+a));q<l+b&&(b+=q-(l+b));d+=b;l+=b;f+=a;n+=
a},getCorner:function(b){var d=a();switch(b){case "ne":return[d.x2,d.y];case "nw":return[d.x,d.y];case "se":return[d.x2,d.y2];case "sw":return[d.x,d.y2]}},getFixed:a}}(),X=function(){function b(){return d(C.getFixed())}function d(a){I.top.css({left:p(a.x),width:p(a.w),height:p(a.y)});I.bottom.css({top:p(a.y2),left:p(a.x),width:p(a.w),height:p(s-a.y2)});I.right.css({left:p(a.x2),width:p(q-a.x2)});I.left.css({width:p(a.x)})}function f(){return a("<div />").css({position:"absolute",backgroundColor:g.shadeColor||
g.bgColor}).appendTo(y)}function e(){h||(h=!0,y.insertBefore(m),b(),w.setBgOpacity(1,0,1),U.hide(),c(g.shadeColor||g.bgColor,1),w.isAwake()?n(g.bgOpacity,1):n(1,1))}function c(a,b){Q(k(),a,b)}function l(){h&&(y.remove(),U.show(),h=!1,w.isAwake()?w.setBgOpacity(g.bgOpacity,1,1):(w.setBgOpacity(1,1,1),w.disableHandles()),Q(K,0,1))}function n(a,b){h&&(g.bgFade&&!b?y.animate({opacity:1-a},{queue:!1,duration:g.fadeTime}):y.css({opacity:1-a}))}function k(){return y.children()}var h=!1,y=a("<div />").css({position:"absolute",
zIndex:240,opacity:0}),I={top:f(),left:f().height(s),right:f().height(s),bottom:f()};return{update:b,updateRaw:d,getShades:k,setBgColor:c,enable:e,disable:l,resize:function(a,b){I.left.css({height:p(b)});I.right.css({height:p(b)})},refresh:function(){g.shade?e():l();w.isAwake()&&n(g.bgOpacity)},opacity:n}}(),w=function(){function b(d,f){var e=a("<div />").mousedown(r(d)).css({cursor:d+"-resize",position:"absolute",zIndex:f}).addClass("ord-"+d);V.support&&e.bind("touchstart.jcrop",V.createDragger(d));
aa.append(e);return e}function d(a){var f;for(f=0;f<a.length;f++)b(a[f],s++).addClass("jcrop-dragbar")}function e(b){var d,f;for(f=0;f<b.length;f++){switch(b[f]){case "n":d="hline";break;case "s":d="hline bottom";break;case "e":d="vline right";break;case "w":d="vline"}var c=F,l=b[f],n=d,n=a("<div />").css({position:"absolute",opacity:g.borderOpacity}).addClass(g.baseClass+"-"+n);I.append(n);c[l]=n}}function c(a){var d;for(d=0;d<a.length;d++){var f=t,e=a[d],n=g.handleSize,l=b(a[d],s++).css({opacity:g.handleOpacity}).addClass(g.baseClass+
"-handle");n&&l.width(n).height(n);f[e]=l}}function l(){var a=C.getFixed();C.setPressed([a.x,a.y]);C.setCurrent([a.x2,a.y2]);n()}function n(a){if(q)return k(a)}function k(a){var b=C.getFixed(),d=b.h;ba.width(Math.round(b.w)).height(Math.round(d));var d=b.x,e=b.y;g.shade||U.css({top:p(-e),left:p(-d)});ba.css({top:p(e),left:p(d)});g.shade&&X.updateRaw(b);q||(ba.show(),g.shade?X.opacity(ca):h(ca,!0),q=!0);a?g.onSelect.call(T,f(b)):g.onChange.call(T,f(b))}function h(a,b,d){if(q||b)g.bgFade&&!d?m.animate({opacity:a},
{queue:!1,duration:g.fadeTime}):m.css("opacity",a)}function y(){R=!0;if(g.allowResize)return aa.show(),!0}function z(){R=!1;aa.hide()}function H(a){a?(ia=!0,z()):(ia=!1,y())}var q,s=370,F={},t={},R=!1;g.dragEdges&&a.isArray(g.createDragbars)&&d(g.createDragbars);a.isArray(g.createHandles)&&c(g.createHandles);g.drawBorders&&a.isArray(g.createBorders)&&e(g.createBorders);a(document).bind("touchstart.jcrop-ios",function(b){a(b.currentTarget).hasClass("jcrop-tracker")&&b.stopPropagation()});var u=A().mousedown(r("move")).css({cursor:"move",
position:"absolute",zIndex:360});V.support&&u.bind("touchstart.jcrop",V.createDragger("move"));I.append(u);z();return{updateVisible:n,update:k,release:function(){z();ba.hide();g.shade?X.opacity(1):h(1);q=!1;g.onRelease.call(T)},refresh:l,isAwake:function(){return q},setCursor:function(a){u.css("cursor",a)},enableHandles:y,enableOnly:function(){R=!0},showHandles:function(){R&&aa.show()},disableHandles:z,animMode:H,setBgOpacity:h,done:function(){H(!1);l()}}}(),W=function(){function b(a){n(l(a));return!1}
function d(b){b.preventDefault();b.stopPropagation();Z&&(Z=!1,k(l(b)),w.isAwake()&&g.onSelect.call(T,f(C.getFixed())),Y.css({zIndex:290}),a(document).unbind(".jcrop"),n=function(){},k=function(){});return!1}function e(a){n(l(V.cfilter(a)));return!1}function c(a){return d(V.cfilter(a))}var n=function(){},k=function(){},h=g.trackDocument;h||Y.mousemove(b).mouseup(d).mouseout(d);m.before(Y);return{activateHandlers:function(f,l,g){Z=!0;n=f;k=l;Y.css({zIndex:450});g?a(document).bind("touchmove.jcrop",
e).bind("touchend.jcrop",c):h&&a(document).bind("mousemove.jcrop",b).bind("mouseup.jcrop",d);return!1},setCursor:function(a){Y.css("cursor",a)}}}(),ha=function(){function b(a){e.hide()}function d(a,b,f){g.allowMove&&(C.moveOffset([b,f]),w.updateVisible(!0));a.preventDefault();a.stopPropagation()}function f(a){if(a.ctrlKey||a.metaKey)return!0;var b=(ka=a.shiftKey?!0:!1)?10:1;switch(a.keyCode){case 37:d(a,-b,0);break;case 39:d(a,b,0);break;case 38:d(a,0,-b);break;case 40:d(a,0,b);break;case 27:g.allowSelect&&
w.release();break;case 9:return!0}return!1}var e=a('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),c=a("<div />").css({position:"absolute",overflow:"hidden"}).append(e);g.keySupport&&(e.keydown(f).blur(b),B||!g.fixedSupport?(e.css({position:"absolute",left:"-20px"}),c.append(e).insertBefore(m)):e.insertBefore(m));return{watchKeys:function(){g.keySupport&&(e.show(),e.focus())}}}();V.support&&Y.bind("touchstart.jcrop",V.newSelection);aa.hide();z(!0);
var T={setImage:function(a,b){w.release();N();var d=new Image;d.onload=function(){var f=d.height,e=g.boxWidth,c=g.boxHeight;m.width(d.width).height(f);m.attr("src",a);U.attr("src",a);x(m,e,c);q=m.width();s=m.height();U.width(q).height(s);Y.width(q+2*R).height(s+2*R);K.width(q).height(s);X.resize(q,s);O();"function"===typeof b&&b.call(T)};d.src=a},animateTo:function(a,b){var d=a[0]/J,f=a[1]/L,e=a[2]/J,c=a[3]/L;if(!ia){var n=C.flipCoords(d,f,e,c),l=C.getFixed(),k=[l.x,l.y,l.x2,l.y2],h=g.animationDelay,
y=n[0]-k[0],m=n[1]-k[1],I=n[2]-k[2],z=n[3]-k[3],q=0,H=g.swingSpeed,d=k[0],f=k[1],e=k[2],c=k[3];w.animMode(!0);var p=function(){return function(){q+=(100-q)/H;k[0]=Math.round(d+q/100*y);k[1]=Math.round(f+q/100*m);k[2]=Math.round(e+q/100*I);k[3]=Math.round(c+q/100*z);99.8<=q&&(q=100);100>q?(E(k),window.setTimeout(p,h)):(w.done(),w.animMode(!1),"function"===typeof b&&b.call(T))}}();window.setTimeout(p,h)}},setSelect:D,setOptions:function(a){y(a);z()},tellSelect:function(){return f(C.getFixed())},tellScaled:function(){return C.getFixed()},
setClass:function(a){K.removeClass().addClass(g.baseClass+"-holder").addClass(a)},disable:N,enable:O,cancel:function(){w.done();W.activateHandlers(null,null)},release:w.release,destroy:function(){K.remove();t.show();t.css("visibility","visible");a(c).removeData("Jcrop")},focus:ha.watchKeys,getBounds:function(){return[q*J,s*L]},getWidgetSize:function(){return[q,s]},getScaleFactor:function(){return[J,L]},getOptions:function(){return g},ui:{holder:K,selection:ba}};S&&K.bind("selectstart",function(){return!1});
t.data("Jcrop",T);return T};a.fn.Jcrop=function(c,h){var p;this.each(function(){if(a(this).data("Jcrop")){if("api"===c)return a(this).data("Jcrop");a(this).data("Jcrop").setOptions(c)}else"IMG"==this.tagName?a.Jcrop.Loader(this,function(){a(this).css({display:"block",visibility:"hidden"});p=a.Jcrop(this,c);a.isFunction(h)&&h.call(p)}):(a(this).css({display:"block",visibility:"hidden"}),p=a.Jcrop(this,c),a.isFunction(h)&&h.call(p))});return this};a.Jcrop.Loader=function(c,h,p){function b(){y.complete?
(l.unbind(".jcloader"),a.isFunction(h)&&h.call(y)):window.setTimeout(b,50)}var l=a(c),y=l[0];l.bind("load.jcloader",b).bind("error.jcloader",function(b){l.unbind(".jcloader");a.isFunction(p)&&p.call(y)});y.complete&&a.isFunction(h)&&(l.unbind(".jcloader"),h.call(y))};a.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:0.6,bgFade:!1,borderOpacity:0.4,handleOpacity:0.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:"n s e w nw ne se sw".split(" "),
createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}})(jQuery);(function(a){var c,h,p={method:"GET",contentType:"json",queryParam:"q",searchDelay:300,minChars:1,propertyToSearch:"name",jsonContainer:null,hintText:"Type in a search term",noResultsText:"No results",searchingText:"Searching...",deleteText:"&times;",animateDropdown:!0,tokenLimit:null,tokenDelimiter:",",preventDuplicates:!1,tokenValue:"id",prePopulate:null,processPrePopulate:!1,idPrefix:"token-input-",resultsFormatter:function(a){return"<li>"+a[this.propertyToSearch]+"</li>"},tokenFormatter:function(a){return"<li><p>"+
a[this.propertyToSearch]+"</p></li>"},onResult:null,onAdd:null,onDelete:null,onReady:null},b={tokenList:"token-input-list",token:"token-input-token",tokenDelete:"token-input-delete-token",selectedToken:"token-input-selected-token",highlightedToken:"token-input-highlighted-token",dropdown:"token-input-dropdown",dropdownItem:"token-input-dropdown-item",dropdownItem2:"token-input-dropdown-item2",selectedDropdownItem:"token-input-selected-dropdown-item",inputToken:"token-input-input-token"};c=0;h=1;var l=
{init:function(b,e){var d=a.extend({},p,e||{});return this.each(function(){a(this).data("tokenInputObject",new a.TokenList(this,b,d))})},clear:function(){this.data("tokenInputObject").clear();return this},add:function(a){this.data("tokenInputObject").add(a);return this},remove:function(a){this.data("tokenInputObject").remove(a);return this},get:function(){return this.data("tokenInputObject").getTokens()}};a.fn.tokenInput=function(a){return l[a]?l[a].apply(this,Array.prototype.slice.call(arguments,
1)):l.init.apply(this,arguments)};a.TokenList=function(l,e,d){function k(){null!==d.tokenLimit&&g>=d.tokenLimit&&(B.hide(),u())}function p(b){var f=d.tokenFormatter(b),f=a(f).addClass(d.classes.token).insertBefore(s);a("<span>"+d.deleteText+"</span>").addClass(d.classes.tokenDelete).appendTo(f).click(function(){v(a(this).parent());t.change();return!1});var e={id:b.id};e[d.propertyToSearch]=b[d.propertyToSearch];a.data(f.get(0),"tokeninput",b);z=z.slice(0,H).concat([e]).concat(z.slice(H));H++;G(z,
t);g+=1;null!==d.tokenLimit&&g>=d.tokenLimit&&(B.hide(),u());return f}function r(b){var f=d.onAdd;if(0<g&&d.preventDuplicates){var e=null;q.children().each(function(){var d=a(this),f=a.data(d.get(0),"tokeninput");if(f&&f.id===b.id)return e=d,!1});if(e){x(e);s.insertAfter(e);B.focus();return}}if(null==d.tokenLimit||g<d.tokenLimit)p(b),k();B.val("");u();a.isFunction(f)&&f.call(t,b)}function x(a){a.addClass(d.classes.selectedToken);n=a.get(0);B.val("");u()}function f(a,b){a.removeClass(d.classes.selectedToken);
n=null;b===c?(s.insertBefore(a),H--):b===h?(s.insertAfter(a),H++):(s.appendTo(q),H=g);B.focus()}function v(b){var f=a.data(b.get(0),"tokeninput"),e=d.onDelete,c=b.prevAll().length;c>H&&c--;b.remove();n=null;B.focus();z=z.slice(0,c).concat(z.slice(c+1));c<H&&H--;G(z,t);g-=1;null!==d.tokenLimit&&B.show().val("").focus();a.isFunction(e)&&e.call(t,f)}function G(b,f){var e=a.map(b,function(a){return a[d.tokenValue]});f.val(e.join(d.tokenDelimiter))}function u(){K.hide().empty();m=null}function A(){K.css({position:"absolute",
top:a(q).offset().top+a(q).outerHeight(),left:a(q).offset().left,zindex:999}).show()}function D(b,f){if(f&&f.length){K.empty();var e=a("<ul>").appendTo(K).mouseover(function(b){E(a(b.target).closest("li"))}).mousedown(function(b){r(a(b.target).closest("li").data("tokeninput"));t.change();return!1}).hide();a.each(f,function(f,c){var l=d.resultsFormatter(c),l=l.replace(RegExp("(?![^&;]+;)(?!<[^<>]*)("+c[d.propertyToSearch]+")(?![^<>]*>)(?![^&;]+;)","g"),c[d.propertyToSearch].replace(RegExp("(?![^&;]+;)(?!<[^<>]*)("+
b+")(?![^<>]*>)(?![^&;]+;)","gi"),"<b>$1</b>")),l=a(l).appendTo(e);f%2?l.addClass(d.classes.dropdownItem):l.addClass(d.classes.dropdownItem2);0===f&&E(l);a.data(l.get(0),"tokeninput",c)});A();d.animateDropdown?e.slideDown("fast"):e.show()}else d.noResultsText&&(K.html("<p>"+d.noResultsText+"</p>"),A())}function E(b){b&&(m&&(a(m).removeClass(d.classes.selectedDropdownItem),m=null),b.addClass(d.classes.selectedDropdownItem),m=b.get(0))}function N(){var b=B.val().toLowerCase();b&&b.length&&(n&&f(a(n),
h),b.length>=d.minChars?(d.searchingText&&(K.html("<p>"+d.searchingText+"</p>"),A()),clearTimeout(P),P=setTimeout(function(){O(b)},d.searchDelay)):u())}function O(b){var f=b+Q(),e=M.get(f);if(e)D(b,e);else if(d.url){var e=Q(),c={data:{}};-1<e.indexOf("?")?(e=e.split("?"),c.url=e[0],e=e[1].split("&"),a.each(e,function(a,b){var d=b.split("=");c.data[d[0]]=d[1]})):c.url=e;c.data[d.queryParam]=b;c.type=d.method;c.dataType=d.contentType;d.crossDomain&&(c.dataType="jsonp");c.success=function(e){a.isFunction(d.onResult)&&
(e=d.onResult.call(t,e));M.add(f,d.jsonContainer?e[d.jsonContainer]:e);B.val().toLowerCase()===b&&D(b,d.jsonContainer?e[d.jsonContainer]:e)};a.ajax(c)}else d.local_data&&(e=a.grep(d.local_data,function(a){return-1<a[d.propertyToSearch].toLowerCase().indexOf(b.toLowerCase())}),a.isFunction(d.onResult)&&(e=d.onResult.call(t,e)),M.add(f,e),D(b,e))}function Q(){var a=d.url;"function"==typeof d.url&&(a=d.url.call());return a}"string"===a.type(e)||"function"===a.type(e)?(d.url=e,e=Q(),void 0===d.crossDomain&&
(-1===e.indexOf("://")?d.crossDomain=!1:d.crossDomain=location.href.split(/\/+/g)[1]!==e.split(/\/+/g)[1])):"object"===typeof e&&(d.local_data=e);d.classes?d.classes=a.extend({},b,d.classes):d.theme?(d.classes={},a.each(b,function(a,b){d.classes[a]=b+"-"+d.theme})):d.classes=b;var z=[],g=0,M=new a.TokenList.Cache,P,S,B=a('<input type="text"  autocomplete="off">').css({outline:"none"}).attr("id",d.idPrefix+l.id).focus(function(){if((null===d.tokenLimit||d.tokenLimit!==g)&&d.hintText)K.html("<p>"+d.hintText+
"</p>"),A()}).blur(function(){u();a(this).val("")}).bind("keyup keydown blur update",function(){if(S!==(S=B.val())){var a=S.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");U.html(a);B.width(U.width()+30)}}).keydown(function(b){var d,e;switch(b.keyCode){case 37:case 39:case 38:case 40:if(a(this).val())return d=null,d=40===b.keyCode||39===b.keyCode?a(m).next():a(m).prev(),d.length&&E(d),!1;d=s.prev();e=s.next();d.length&&d.get(0)===n||e.length&&e.get(0)===n?37===b.keyCode||
38===b.keyCode?f(a(n),c):f(a(n),h):(37===b.keyCode||38===b.keyCode)&&d.length?x(a(d.get(0))):(39===b.keyCode||40===b.keyCode)&&e.length&&x(a(e.get(0)));break;case 8:d=s.prev();if(a(this).val().length)1===a(this).val().length?u():setTimeout(function(){N()},5);else return n?(v(a(n)),t.change()):d.length&&x(a(d.get(0))),!1;break;case 9:case 13:case 108:case 188:if(m)return r(a(m).data("tokeninput")),t.change(),!1;break;case 27:return u(),!0;default:String.fromCharCode(b.which)&&setTimeout(function(){N()},
5)}}),t=a(l).hide().val("").focus(function(){B.focus()}).blur(function(){B.blur()}),n=null,H=0,m=null,q=a("<ul />").addClass(d.classes.tokenList).click(function(b){if((b=a(b.target).closest("li"))&&b.get(0)&&a.data(b.get(0),"tokeninput")){var d=n;n&&f(a(n),2);d===b.get(0)?f(b,2):x(b)}else n&&f(a(n),2),B.focus()}).mouseover(function(b){(b=a(b.target).closest("li"))&&n!==this&&b.addClass(d.classes.highlightedToken)}).mouseout(function(b){(b=a(b.target).closest("li"))&&n!==this&&b.removeClass(d.classes.highlightedToken)}).insertBefore(t),
s=a("<li />").addClass(d.classes.inputToken).appendTo(q).append(B),K=a("<div>").addClass(d.classes.dropdown).appendTo("body").hide(),U=a("<tester/>").insertAfter(B).css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:B.css("fontSize"),fontFamily:B.css("fontFamily"),fontWeight:B.css("fontWeight"),letterSpacing:B.css("letterSpacing"),whiteSpace:"nowrap"});t.val("");l=d.prePopulate||t.data("pre");d.processPrePopulate&&a.isFunction(d.onResult)&&(l=d.onResult.call(t,l));l&&l.length&&a.each(l,
function(a,b){p(b);k()});a.isFunction(d.onReady)&&d.onReady.call();this.clear=function(){q.children("li").each(function(){0===a(this).children("input").length&&v(a(this))})};this.add=function(a){r(a)};this.remove=function(b){q.children("li").each(function(){if(0===a(this).children("input").length){var d=a(this).data("tokeninput"),e=!0,f;for(f in b)if(b[f]!==d[f]){e=!1;break}e&&v(a(this))}})};this.getTokens=function(){return z}};a.TokenList.Cache=function(b){var e=a.extend({max_size:500},b),d={},c=
0;this.add=function(a,b){c>e.max_size&&(d={},c=0);d[a]||(c+=1);d[a]=b};this.get=function(a){return d[a]}}})(jQuery);(function(a){function c(b){var c=b||window.event,h=[].slice.call(arguments,1),e=0,d=0,k=0;b=a.event.fix(c);b.type="mousewheel";c.wheelDelta&&(e=c.wheelDelta/120);c.detail&&(e=-c.detail/3);k=e;void 0!==c.axis&&c.axis===c.HORIZONTAL_AXIS&&(k=0,d=-1*e);void 0!==c.wheelDeltaY&&(k=c.wheelDeltaY/120);void 0!==c.wheelDeltaX&&(d=-1*c.wheelDeltaX/120);h.unshift(b,e,d,k);return(a.event.dispatch||a.event.handle).apply(this,h)}var h=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var p=h.length;p;)a.event.fixHooks[h[--p]]=
a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=h.length;a;)this.addEventListener(h[--a],c,!1);else this.onmousewheel=c},teardown:function(){if(this.removeEventListener)for(var a=h.length;a;)this.removeEventListener(h[--a],c,!1);else this.onmousewheel=null}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(jQuery);(function(a){var c={init:function(b){b=a.extend(!0,{set_width:!1,set_height:!1,horizontalScroll:!1,scrollInertia:950,mouseWheel:!0,mouseWheelPixels:"auto",autoDraggerLength:!0,autoHideScrollbar:!1,alwaysShowScrollbar:!1,snapAmount:null,snapOffset:0,scrollButtons:{enable:!1,scrollType:"continuous",scrollSpeed:"auto",scrollAmount:40},advanced:{updateOnBrowserResize:!0,updateOnContentResize:!1,autoExpandHorizontalScroll:!1,autoScrollOnFocus:!0,normalizeMouseWheelDelta:!1},contentTouchScroll:!0,callbacks:{onScrollStart:function(){},
onScroll:function(){},onTotalScroll:function(){},onTotalScrollBack:function(){},onTotalScrollOffset:0,onTotalScrollBackOffset:0,whileScrolling:function(){}},theme:"light"},b);return this.each(function(){var c=a(this);b.set_width&&c.css("width",b.set_width);b.set_height&&c.css("height",b.set_height);if(a(document).data("mCustomScrollbar-index")){var h=parseInt(a(document).data("mCustomScrollbar-index"));a(document).data("mCustomScrollbar-index",h+1)}else a(document).data("mCustomScrollbar-index","1");
c.wrapInner("<div class='mCustomScrollBox mCS-"+b.theme+"' id='mCSB_"+a(document).data("mCustomScrollbar-index")+"' style='position:relative; height:100%; overflow:hidden; max-width:100%;' />").addClass("mCustomScrollbar _mCS_"+a(document).data("mCustomScrollbar-index"));var e=c.children(".mCustomScrollBox");b.horizontalScroll?(e.addClass("mCSB_horizontal").wrapInner("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />"),h=e.children(".mCSB_h_wrapper"),h.wrapInner("<div class='mCSB_container' style='position:absolute; left:0;' />").children(".mCSB_container").css({width:h.children().outerWidth(),
position:"relative"}).unwrap()):e.wrapInner("<div class='mCSB_container' style='position:relative; top:0;' />");var d=e.children(".mCSB_container");a.support.touch&&d.addClass("mCS_touch");d.after("<div class='mCSB_scrollTools' style='position:absolute;'><div class='mCSB_draggerContainer'><div class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' style='position:relative;'></div></div><div class='mCSB_draggerRail'></div></div></div>");var h=e.children(".mCSB_scrollTools"),
k=h.children(".mCSB_draggerContainer").children(".mCSB_dragger");b.horizontalScroll?k.data("minDraggerWidth",k.width()):k.data("minDraggerHeight",k.height());b.scrollButtons.enable&&(b.horizontalScroll?h.prepend("<a class='mCSB_buttonLeft' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonRight' oncontextmenu='return false;'></a>"):h.prepend("<a class='mCSB_buttonUp' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonDown' oncontextmenu='return false;'></a>"));e.bind("scroll",
function(){c.is(".mCS_disabled")||e.scrollTop(0).scrollLeft(0)});c.data({mCS_Init:!0,mCustomScrollbarIndex:a(document).data("mCustomScrollbar-index"),horizontalScroll:b.horizontalScroll,scrollInertia:b.scrollInertia,scrollEasing:"mcsEaseOut",mouseWheel:b.mouseWheel,mouseWheelPixels:b.mouseWheelPixels,autoDraggerLength:b.autoDraggerLength,autoHideScrollbar:b.autoHideScrollbar,alwaysShowScrollbar:b.alwaysShowScrollbar,snapAmount:b.snapAmount,snapOffset:b.snapOffset,scrollButtons_enable:b.scrollButtons.enable,
scrollButtons_scrollType:b.scrollButtons.scrollType,scrollButtons_scrollSpeed:b.scrollButtons.scrollSpeed,scrollButtons_scrollAmount:b.scrollButtons.scrollAmount,autoExpandHorizontalScroll:b.advanced.autoExpandHorizontalScroll,autoScrollOnFocus:b.advanced.autoScrollOnFocus,normalizeMouseWheelDelta:b.advanced.normalizeMouseWheelDelta,contentTouchScroll:b.contentTouchScroll,onScrollStart_Callback:b.callbacks.onScrollStart,onScroll_Callback:b.callbacks.onScroll,onTotalScroll_Callback:b.callbacks.onTotalScroll,
onTotalScrollBack_Callback:b.callbacks.onTotalScrollBack,onTotalScroll_Offset:b.callbacks.onTotalScrollOffset,onTotalScrollBack_Offset:b.callbacks.onTotalScrollBackOffset,whileScrolling_Callback:b.callbacks.whileScrolling,bindEvent_scrollbar_drag:!1,bindEvent_content_touch:!1,bindEvent_scrollbar_click:!1,bindEvent_mousewheel:!1,bindEvent_buttonsContinuous_y:!1,bindEvent_buttonsContinuous_x:!1,bindEvent_buttonsPixels_y:!1,bindEvent_buttonsPixels_x:!1,bindEvent_focusin:!1,bindEvent_autoHideScrollbar:!1,
mCSB_buttonScrollRight:!1,mCSB_buttonScrollLeft:!1,mCSB_buttonScrollDown:!1,mCSB_buttonScrollUp:!1});if(b.horizontalScroll)"none"!==c.css("max-width")&&!b.advanced.updateOnContentResize&&(b.advanced.updateOnContentResize=!0);else if("none"!==c.css("max-height")){var p=!1,h=parseInt(c.css("max-height"));0<=c.css("max-height").indexOf("%")&&(p=h,h=c.parent().height()*p/100);c.css("overflow","hidden");e.css("max-height",h)}c.mCustomScrollbar("update");if(b.advanced.updateOnBrowserResize){var r,x=a(window).width(),
f=a(window).height();a(window).bind("resize."+c.data("mCustomScrollbarIndex"),function(){r&&clearTimeout(r);r=setTimeout(function(){if(!c.is(".mCS_disabled")&&!c.is(".mCS_destroyed")){var b=a(window).width(),d=a(window).height();if(x!==b||f!==d)"none"!==c.css("max-height")&&p&&e.css("max-height",c.parent().height()*p/100),c.mCustomScrollbar("update"),x=b,f=d}},150)})}if(b.advanced.updateOnContentResize){var v=b.horizontalScroll?d.outerWidth():d.outerHeight();setInterval(function(){if(b.horizontalScroll){b.advanced.autoExpandHorizontalScroll&&
d.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:d.outerWidth(),position:"relative"}).unwrap();var a=d.outerWidth()}else a=d.outerHeight();a!=v&&(c.mCustomScrollbar("update"),v=a)},300)}})},update:function(){var b=a(this),c=b.children(".mCustomScrollBox"),h=c.children(".mCSB_container");h.removeClass("mCS_no_scrollbar");b.removeClass("mCS_disabled mCS_destroyed");c.scrollTop(0).scrollLeft(0);var e=c.children(".mCSB_scrollTools"),
d=e.children(".mCSB_draggerContainer"),k=d.children(".mCSB_dragger");if(b.data("horizontalScroll")){var p=e.children(".mCSB_buttonLeft"),r=e.children(".mCSB_buttonRight"),x=c.width();b.data("autoExpandHorizontalScroll")&&h.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:h.outerWidth(),position:"relative"}).unwrap();var f=h.outerWidth()}else var v=e.children(".mCSB_buttonUp"),G=e.children(".mCSB_buttonDown"),
u=c.height(),A=h.outerHeight();A>u&&!b.data("horizontalScroll")?(e.css("display","block"),x=d.height(),b.data("autoDraggerLength")&&(f=Math.round(u/A*x),e=k.data("minDraggerHeight"),f<=e?k.css({height:e}):f>=x-10?k.css({height:x-10}):k.css({height:f}),k.children(".mCSB_dragger_bar").css({"line-height":k.height()+"px"})),f=k.height(),b.data("scrollAmount",(A-u)/(x-f)).mCustomScrollbar("scrolling",c,h,d,k,v,G,p,r),c=Math.abs(h.position().top),b.mCustomScrollbar("scrollTo",c,{scrollInertia:0,trigger:"internal"})):
f>x&&b.data("horizontalScroll")?(e.css("display","block"),u=d.width(),b.data("autoDraggerLength")&&(A=Math.round(x/f*u),e=k.data("minDraggerWidth"),A<=e?k.css({width:e}):A>=u-10?k.css({width:u-10}):k.css({width:A})),A=k.width(),b.data("scrollAmount",(f-x)/(u-A)).mCustomScrollbar("scrolling",c,h,d,k,v,G,p,r),c=Math.abs(h.position().left),b.mCustomScrollbar("scrollTo",c,{scrollInertia:0,trigger:"internal"})):(c.unbind("mousewheel focusin"),b.data("horizontalScroll")?k.add(h).css("left",0):k.add(h).css("top",
0),b.data("alwaysShowScrollbar")?b.data("horizontalScroll")?b.data("horizontalScroll")&&k.css({width:d.width()}):k.css({height:d.height()}):(e.css("display","none"),h.addClass("mCS_no_scrollbar")),b.data({bindEvent_mousewheel:!1,bindEvent_focusin:!1}))},scrolling:function(b,c,p,e,d,k,F,r){function x(a,b,d,c){f.data("horizontalScroll")?f.mCustomScrollbar("scrollTo",e.position().left-b+c,{moveDragger:!0,trigger:"internal"}):f.mCustomScrollbar("scrollTo",e.position().top-a+d,{moveDragger:!0,trigger:"internal"})}
var f=a(this);if(!f.data("bindEvent_scrollbar_drag")){var v,G,u,A,D;a.support.pointer?(u="pointerdown",A="pointermove",D="pointerup"):a.support.msPointer&&(u="MSPointerDown",A="MSPointerMove",D="MSPointerUp");a.support.pointer||a.support.msPointer?(e.bind(u,function(b){b.preventDefault();f.data({on_drag:!0});e.addClass("mCSB_dragger_onDrag");var d=a(this),c=d.offset(),g=b.originalEvent.pageX-c.left;b=b.originalEvent.pageY-c.top;g<d.width()&&(0<g&&b<d.height()&&0<b)&&(v=b,G=g)}),a(document).bind(A+
"."+f.data("mCustomScrollbarIndex"),function(a){a.preventDefault();if(f.data("on_drag")){var b=e.offset();x(v,G,a.originalEvent.pageY-b.top,a.originalEvent.pageX-b.left)}}).bind(D+"."+f.data("mCustomScrollbarIndex"),function(a){f.data({on_drag:!1});e.removeClass("mCSB_dragger_onDrag")})):(e.bind("mousedown touchstart",function(b){b.preventDefault();b.stopImmediatePropagation();var d=a(this),c=d.offset(),g;"touchstart"===b.type?b=b.originalEvent.touches[0]||b.originalEvent.changedTouches[0]:(f.data({on_drag:!0}),
e.addClass("mCSB_dragger_onDrag"));g=b.pageX-c.left;c=b.pageY-c.top;g<d.width()&&(0<g&&c<d.height()&&0<c)&&(v=c,G=g)}).bind("touchmove",function(b){b.preventDefault();b.stopImmediatePropagation();b=b.originalEvent.touches[0]||b.originalEvent.changedTouches[0];var d=a(this).offset();x(v,G,b.pageY-d.top,b.pageX-d.left)}),a(document).bind("mousemove."+f.data("mCustomScrollbarIndex"),function(a){if(f.data("on_drag")){var b=e.offset();x(v,G,a.pageY-b.top,a.pageX-b.left)}}).bind("mouseup."+f.data("mCustomScrollbarIndex"),
function(a){f.data({on_drag:!1});e.removeClass("mCSB_dragger_onDrag")}));f.data({bindEvent_scrollbar_drag:!0})}if(a.support.touch&&f.data("contentTouchScroll")&&!f.data("bindEvent_content_touch")){var E,N,O,Q,z,g,M;c.bind("touchstart",function(b){b.stopImmediatePropagation();E=b.originalEvent.touches[0]||b.originalEvent.changedTouches[0];N=a(this);O=N.offset();z=E.pageX-O.left;g=Q=E.pageY-O.top;M=z});c.bind("touchmove",function(b){b.preventDefault();b.stopImmediatePropagation();E=b.originalEvent.touches[0]||
b.originalEvent.changedTouches[0];N=a(this).parent();O=N.offset();z=E.pageX-O.left;Q=E.pageY-O.top;f.data("horizontalScroll")?f.mCustomScrollbar("scrollTo",M-z,{trigger:"internal"}):f.mCustomScrollbar("scrollTo",g-Q,{trigger:"internal"})})}f.data("bindEvent_scrollbar_click")||(p.bind("click",function(b){var d=(b.pageY-p.offset().top)*f.data("scrollAmount"),c=a(b.target);f.data("horizontalScroll")&&(d=(b.pageX-p.offset().left)*f.data("scrollAmount"));(c.hasClass("mCSB_draggerContainer")||c.hasClass("mCSB_draggerRail"))&&
f.mCustomScrollbar("scrollTo",d,{trigger:"internal",scrollEasing:"draggerRailEase"})}),f.data({bindEvent_scrollbar_click:!0}));f.data("mouseWheel")&&!f.data("bindEvent_mousewheel")&&(b.bind("mousewheel",function(a,b){var d=f.data("mouseWheelPixels"),g=Math.abs(c.position().top),h=e.position().top,k=p.height()-e.height();f.data("normalizeMouseWheelDelta")&&(b=0>b?-1:1);"auto"===d&&(d=100+Math.round(f.data("scrollAmount")/2));f.data("horizontalScroll")&&(h=e.position().left,k=p.width()-e.width(),g=
Math.abs(c.position().left));if(0<b&&0!==h||0>b&&h!==k)a.preventDefault(),a.stopImmediatePropagation();f.mCustomScrollbar("scrollTo",g-b*d,{trigger:"internal"})}),f.data({bindEvent_mousewheel:!0}));if(f.data("scrollButtons_enable"))if("pixels"===f.data("scrollButtons_scrollType")){f.data("horizontalScroll")?(r.add(F).unbind("mousedown touchstart MSPointerDown pointerdown mouseup MSPointerUp pointerup mouseout MSPointerOut pointerout touchend",S,B),f.data({bindEvent_buttonsContinuous_x:!1}),f.data("bindEvent_buttonsPixels_x")||
(r.bind("click",function(a){a.preventDefault();P(Math.abs(c.position().left)+f.data("scrollButtons_scrollAmount"))}),F.bind("click",function(a){a.preventDefault();P(Math.abs(c.position().left)-f.data("scrollButtons_scrollAmount"))}),f.data({bindEvent_buttonsPixels_x:!0}))):(k.add(d).unbind("mousedown touchstart MSPointerDown pointerdown mouseup MSPointerUp pointerup mouseout MSPointerOut pointerout touchend",S,B),f.data({bindEvent_buttonsContinuous_y:!1}),f.data("bindEvent_buttonsPixels_y")||(k.bind("click",
function(a){a.preventDefault();P(Math.abs(c.position().top)+f.data("scrollButtons_scrollAmount"))}),d.bind("click",function(a){a.preventDefault();P(Math.abs(c.position().top)-f.data("scrollButtons_scrollAmount"))}),f.data({bindEvent_buttonsPixels_y:!0})));var P=function(a){e.data("preventAction")||(e.data("preventAction",!0),f.mCustomScrollbar("scrollTo",a,{trigger:"internal"}))}}else{if(f.data("horizontalScroll")){if(r.add(F).unbind("click"),f.data({bindEvent_buttonsPixels_x:!1}),!f.data("bindEvent_buttonsContinuous_x")){r.bind("mousedown touchstart MSPointerDown pointerdown",
function(a){a.preventDefault();var b=t();f.data({mCSB_buttonScrollRight:setInterval(function(){f.mCustomScrollbar("scrollTo",Math.abs(c.position().left)+b,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var S=function(a){a.preventDefault();clearInterval(f.data("mCSB_buttonScrollRight"))};r.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",S);F.bind("mousedown touchstart MSPointerDown pointerdown",function(a){a.preventDefault();var b=t();f.data({mCSB_buttonScrollLeft:setInterval(function(){f.mCustomScrollbar("scrollTo",
Math.abs(c.position().left)-b,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var B=function(a){a.preventDefault();clearInterval(f.data("mCSB_buttonScrollLeft"))};F.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",B);f.data({bindEvent_buttonsContinuous_x:!0})}}else k.add(d).unbind("click"),f.data({bindEvent_buttonsPixels_y:!1}),f.data("bindEvent_buttonsContinuous_y")||(k.bind("mousedown touchstart MSPointerDown pointerdown",function(a){a.preventDefault();var b=
t();f.data({mCSB_buttonScrollDown:setInterval(function(){f.mCustomScrollbar("scrollTo",Math.abs(c.position().top)+b,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})}),k.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",function(a){a.preventDefault();clearInterval(f.data("mCSB_buttonScrollDown"))}),d.bind("mousedown touchstart MSPointerDown pointerdown",function(a){a.preventDefault();var b=t();f.data({mCSB_buttonScrollUp:setInterval(function(){f.mCustomScrollbar("scrollTo",
Math.abs(c.position().top)-b,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})}),d.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",function(a){a.preventDefault();clearInterval(f.data("mCSB_buttonScrollUp"))}),f.data({bindEvent_buttonsContinuous_y:!0}));var t=function(){var a=f.data("scrollButtons_scrollSpeed");"auto"===f.data("scrollButtons_scrollSpeed")&&(a=Math.round((f.data("scrollInertia")+100)/40));return a}}f.data("autoScrollOnFocus")&&!f.data("bindEvent_focusin")&&
(b.bind("focusin",function(){b.scrollTop(0).scrollLeft(0);var d=a(document.activeElement);if(d.is("input,textarea,select,button,a[tabindex],area,object")){var e=c.position().top,g=d.position().top,h=b.height()-d.outerHeight();f.data("horizontalScroll")&&(e=c.position().left,g=d.position().left,h=b.width()-d.outerWidth());(0>e+g||e+g>h)&&f.mCustomScrollbar("scrollTo",g,{trigger:"internal"})}}),f.data({bindEvent_focusin:!0}));f.data("autoHideScrollbar")&&!f.data("alwaysShowScrollbar")&&!f.data("bindEvent_autoHideScrollbar")&&
(b.bind("mouseenter",function(a){b.addClass("mCS-mouse-over");h.showScrollbar.call(b.children(".mCSB_scrollTools"))}).bind("mouseleave touchend",function(a){b.removeClass("mCS-mouse-over");"mouseleave"===a.type&&h.hideScrollbar.call(b.children(".mCSB_scrollTools"))}),f.data({bindEvent_autoHideScrollbar:!0}))},scrollTo:function(b,c){function p(a){if(e.data("mCustomScrollbarIndex"))switch(this.mcs={top:r.position().top,left:r.position().left,draggerTop:v.position().top,draggerLeft:v.position().left,
topPct:Math.round(100*Math.abs(r.position().top)/Math.abs(r.outerHeight()-F.height())),leftPct:Math.round(100*Math.abs(r.position().left)/Math.abs(r.outerWidth()-F.width()))},a){case "onScrollStart":e.data("mCS_tweenRunning",!0).data("onScrollStart_Callback").call(e,this.mcs);break;case "whileScrolling":e.data("whileScrolling_Callback").call(e,this.mcs);break;case "onScroll":e.data("onScroll_Callback").call(e,this.mcs);break;case "onTotalScrollBack":e.data("onTotalScrollBack_Callback").call(e,this.mcs);
break;case "onTotalScroll":e.data("onTotalScroll_Callback").call(e,this.mcs)}}var e=a(this),d={moveDragger:!1,trigger:"external",callbacks:!0,scrollInertia:e.data("scrollInertia"),scrollEasing:e.data("scrollEasing")};c=a.extend(d,c);var k,F=e.children(".mCustomScrollBox"),r=F.children(".mCSB_container"),x=F.children(".mCSB_scrollTools"),f=x.children(".mCSB_draggerContainer"),v=f.children(".mCSB_dragger"),d=draggerSpeed=c.scrollInertia,G,u,A,D;if(!r.hasClass("mCS_no_scrollbar")&&(e.data({mCS_trigger:c.trigger}),
e.data("mCS_Init")&&(c.callbacks=!1),b||0===b))"number"===typeof b?c.moveDragger?(k=b,b=e.data("horizontalScroll")?v.position().left*e.data("scrollAmount"):v.position().top*e.data("scrollAmount"),draggerSpeed=0):k=b/e.data("scrollAmount"):"string"===typeof b&&(k="top"===b?0:"bottom"===b&&!e.data("horizontalScroll")?r.outerHeight()-F.height():"left"===b?0:"right"===b&&e.data("horizontalScroll")?r.outerWidth()-F.width():"first"===b?e.find(".mCSB_container").find(":first"):"last"===b?e.find(".mCSB_container").find(":last"):
e.find(b),1===k.length?(b=e.data("horizontalScroll")?k.position().left:k.position().top,k=b/e.data("scrollAmount")):k=b=k),e.data("horizontalScroll")?(e.data("onTotalScrollBack_Offset")&&(u=-e.data("onTotalScrollBack_Offset")),e.data("onTotalScroll_Offset")&&(D=F.width()-r.outerWidth()+e.data("onTotalScroll_Offset")),0>k?(k=b=0,clearInterval(e.data("mCSB_buttonScrollLeft")),u||(G=!0)):k>=f.width()-v.width()?(k=f.width()-v.width(),b=F.width()-r.outerWidth(),clearInterval(e.data("mCSB_buttonScrollRight")),
D||(A=!0)):b=-b,(f=e.data("snapAmount"))&&(b=Math.round(b/f)*f-e.data("snapOffset")),h.mTweenAxis.call(this,v[0],"left",Math.round(k),draggerSpeed,c.scrollEasing),h.mTweenAxis.call(this,r[0],"left",Math.round(b),d,c.scrollEasing,{onStart:function(){c.callbacks&&!e.data("mCS_tweenRunning")&&p("onScrollStart");e.data("autoHideScrollbar")&&!e.data("alwaysShowScrollbar")&&h.showScrollbar.call(x)},onUpdate:function(){c.callbacks&&p("whileScrolling")},onComplete:function(){c.callbacks&&(p("onScroll"),(G||
u&&r.position().left>=u)&&p("onTotalScrollBack"),(A||D&&r.position().left<=D)&&p("onTotalScroll"));v.data("preventAction",!1);e.data("mCS_tweenRunning",!1);e.data("autoHideScrollbar")&&!e.data("alwaysShowScrollbar")&&(F.hasClass("mCS-mouse-over")||h.hideScrollbar.call(x))}})):(e.data("onTotalScrollBack_Offset")&&(u=-e.data("onTotalScrollBack_Offset")),e.data("onTotalScroll_Offset")&&(D=F.height()-r.outerHeight()+e.data("onTotalScroll_Offset")),0>k?(k=b=0,clearInterval(e.data("mCSB_buttonScrollUp")),
u||(G=!0)):k>=f.height()-v.height()?(k=f.height()-v.height(),b=F.height()-r.outerHeight(),clearInterval(e.data("mCSB_buttonScrollDown")),D||(A=!0)):b=-b,(f=e.data("snapAmount"))&&(b=Math.round(b/f)*f-e.data("snapOffset")),h.mTweenAxis.call(this,v[0],"top",Math.round(k),draggerSpeed,c.scrollEasing),h.mTweenAxis.call(this,r[0],"top",Math.round(b),d,c.scrollEasing,{onStart:function(){c.callbacks&&!e.data("mCS_tweenRunning")&&p("onScrollStart");e.data("autoHideScrollbar")&&!e.data("alwaysShowScrollbar")&&
h.showScrollbar.call(x)},onUpdate:function(){c.callbacks&&p("whileScrolling")},onComplete:function(){c.callbacks&&(p("onScroll"),(G||u&&r.position().top>=u)&&p("onTotalScrollBack"),(A||D&&r.position().top<=D)&&p("onTotalScroll"));v.data("preventAction",!1);e.data("mCS_tweenRunning",!1);e.data("autoHideScrollbar")&&!e.data("alwaysShowScrollbar")&&(F.hasClass("mCS-mouse-over")||h.hideScrollbar.call(x))}})),e.data("mCS_Init")&&e.data({mCS_Init:!1})},stop:function(){var b=a(this),c=b.children().children(".mCSB_container"),
b=b.children().children().children().children(".mCSB_dragger");h.mTweenAxisStop.call(this,c[0]);h.mTweenAxisStop.call(this,b[0])},disable:function(b){var c=a(this),h=c.children(".mCustomScrollBox"),e=h.children(".mCSB_container"),d=h.children(".mCSB_scrollTools"),k=d.children().children(".mCSB_dragger");h.unbind("mousewheel focusin mouseenter mouseleave touchend");e.unbind("touchstart touchmove");b&&(c.data("horizontalScroll")?k.add(e).css("left",0):k.add(e).css("top",0));d.css("display","none");
e.addClass("mCS_no_scrollbar");c.data({bindEvent_mousewheel:!1,bindEvent_focusin:!1,bindEvent_content_touch:!1,bindEvent_autoHideScrollbar:!1}).addClass("mCS_disabled")},destroy:function(){var b=a(this);b.removeClass("mCustomScrollbar _mCS_"+b.data("mCustomScrollbarIndex")).addClass("mCS_destroyed").children().children(".mCSB_container").unwrap().children().unwrap().siblings(".mCSB_scrollTools").remove();a(document).unbind("mousemove."+b.data("mCustomScrollbarIndex")+" mouseup."+b.data("mCustomScrollbarIndex")+
" MSPointerMove."+b.data("mCustomScrollbarIndex")+" MSPointerUp."+b.data("mCustomScrollbarIndex"));a(window).unbind("resize."+b.data("mCustomScrollbarIndex"))}},h={showScrollbar:function(){this.stop().animate({opacity:1},"fast")},hideScrollbar:function(){this.stop().animate({opacity:0},"fast")},mTweenAxis:function(a,c,h,e,d,k){function p(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?
Date.now():(new Date).getTime()}function r(){E||v.call();E=p()-A;x();E>=a._time&&(a._time=E>a._time?E+D-(E-a._time):E+D-1,a._time<E+1&&(a._time=E+1));a._time<e?a._id=_request(r):u.call()}function x(){0<e?(a.currVal=f(a._time,N,Q,e,d),O[c]=Math.round(a.currVal)+"px"):O[c]=h+"px";G.call()}function f(a,b,c,d,e){switch(e){case "linear":return c*a/d+b;case "easeOutQuad":return a/=d,-c*a*(a-2)+b;case "easeInOutQuad":a/=d/2;if(1>a)return c/2*a*a+b;a--;return-c/2*(a*(a-2)-1)+b;case "easeOutCubic":return a/=
d,a--,c*(a*a*a+1)+b;case "easeOutQuart":return a/=d,a--,-c*(a*a*a*a-1)+b;case "easeOutQuint":return a/=d,a--,c*(a*a*a*a*a+1)+b;case "easeOutCirc":return a/=d,a--,c*Math.sqrt(1-a*a)+b;case "easeOutSine":return c*Math.sin(a/d*(Math.PI/2))+b;case "easeOutExpo":return c*(-Math.pow(2,-10*a/d)+1)+b;case "mcsEaseOut":return d=(a/=d)*a,e=d*a,b+c*(0.499999999999997*e*d+-2.5*d*d+5.5*e+-6.5*d+4*a);case "draggerRailEase":a/=d/2;if(1>a)return c/2*a*a*a+b;a-=2;return c/2*(a*a*a+2)+b}}k=k||{};var v=k.onStart||function(){},
G=k.onUpdate||function(){},u=k.onComplete||function(){},A=p(),D,E=0,N=a.offsetTop,O=a.style;"left"===c&&(N=a.offsetLeft);var Q=h-N;null!=a._id&&(window.requestAnimationFrame?window.cancelAnimationFrame(a._id):clearTimeout(a._id),a._id=null);(function(){D=1E3/60;a._time=E+D;_request=!window.requestAnimationFrame?function(a){x();return setTimeout(a,0.01)}:window.requestAnimationFrame;a._id=_request(r)})()},mTweenAxisStop:function(a){null!=a._id&&(window.requestAnimationFrame?window.cancelAnimationFrame(a._id):
clearTimeout(a._id),a._id=null)},rafPolyfill:function(){for(var a=["ms","moz","webkit","o"],c=a.length;-1<--c&&!window.requestAnimationFrame;)window.requestAnimationFrame=window[a[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[a[c]+"CancelAnimationFrame"]||window[a[c]+"CancelRequestAnimationFrame"]}};h.rafPolyfill.call();a.support.touch=!!("ontouchstart"in window);a.support.pointer=window.navigator.pointerEnabled;a.support.msPointer=window.navigator.msPointerEnabled;var p="https:"==
document.location.protocol?"https:":"http:";a.event.special.mousewheel||document.write('<script src="'+p+'//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.0.6/jquery.mousewheel.min.js">\x3c/script>');a.fn.mCustomScrollbar=function(b){if(c[b])return c[b].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof b||!b)return c.init.apply(this,arguments);a.error("Method "+b+" does not exist")}})(jQuery);$(document).on("click",".ss-link",function(){window.location.href=this.getAttribute("data-ss-link")});$.fn.text_multiline=function(a){this.text(a);this.html(this.html().replace(/\n/g,"<br/>"));return this};function dateToString(a){var c=a.getDate(),h="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a.getMonth()],p=a.getFullYear(),b=a.getHours();a=a.getMinutes();var l="AM";12<=b&&(b-=12,l="PM");0==b&&(b=12);return""+h+" "+(9>=c?"0"+c:c)+", "+p+" at "+(9>=b?"0"+b:b)+":"+(9>=a?"0"+a:a)+" "+l}
function convert_time(){$(".time-ago").each(function(){if(""==this.getAttribute("data-time"))return!0;var a=new Date(1E3*this.getAttribute("data-time")),c=Math.round((new Date-a)/1E3);0>c?(c=0-c,60>c?$(this).html("in a few seconds"):(c=Math.floor(c/60),10>c?$(this).html("in about "+c+" minutes"):$(this).html(dateToString(a)))):60>c?$(this).html("a few seconds ago"):(c=Math.floor(c/60),60>c?$(this).html("about "+c+" minute"+(1<c?"s":"")+" ago"):(c=Math.floor(c/60),24>c?$(this).html("about "+c+" hours ago"):
$(this).html(dateToString(a))))})}convert_time();var convert_time_internval=setInterval(convert_time,6E4);$(document).on("click",".page-tab",function(){var a=".page-tab-"+this.getAttribute("data-ss-tab");$(".page-tab").removeClass("is-active");$(this).addClass("is-active");$(".page-tab-component").hide();$(a).show()});$(document).on("click",".ss-photo",function(){console.log("--Expand photo")});
$(document).on("change",".ss-picture-upload",function(){var a=this;if(a.files&&a.files[0]){var c=a.files[0];if(!c.type.match(/image.*/))return!1;var h=new FileReader;h.onload=function(c){var b=$(a).parents(".ss-file-wrapper").siblings(".ss-picture-preview");c=$("<img/>").attr("src",c.target.result);b.html(c).show();c.Jcrop({aspectRatio:1,minSize:[50,50],setSelect:[100,100,50,50],onSelect:function(a){$('input[name="profile_x"]').val(a.x);$('input[name="profile_y"]').val(a.y);$('input[name="profile_w"]').val(a.w);
$('input[name="profile_h"]').val(a.h)}})};h.readAsDataURL(c)}});$(document).on("click",".thumb-up",function(){var a=$(this).children(".thumb-up-count"),c=$(this).siblings(".thumb-down").children(".thumb-down-count"),h=this.getAttribute("data-pid");$.ajax({url:"/ajax/post/save_thumb",method:"POST",data:{type:"up",id:h}}).done(function(h){0==h.result?(c.text(parseInt(c.text())-1),a.text(parseInt(a.text())+1)):1==h.result&&a.text(parseInt(a.text())+1)})});
$(document).on("click",".thumb-down",function(){var a=$(this).children(".thumb-down-count"),c=$(this).siblings(".thumb-up").children(".thumb-up-count"),h=this.getAttribute("data-pid");$.ajax({url:"/ajax/post/save_thumb",method:"POST",data:{type:"down",id:h}}).done(function(h){0==h.result?(a.text(parseInt(a.text())+1),c.text(parseInt(c.text())-1)):1==h.result&&a.text(parseInt(a.text())+1)})});$(document).on("change",'[name="user_photos[]"]',function(){var a=new FormData;for(i=0;i<this.files.length;i++)a.append("user_photos[]",this.files[i]);$.ajax({url:"/ajax/user/upload_photos",type:"POST",data:a,processData:!1,contentType:!1,dataType:"json"}).done(function(a){console.log(a)})});
$(document).on("mouseenter",".ss-photo",function(){$(this).children(".ss-photo-hover").fadeIn();$(this).children(".ss-photo-delete").fadeIn()}).on("mouseleave",".ss-photo",function(){$(this).children(".ss-photo-hover").fadeOut();$(this).children(".ss-photo-delete").fadeOut()});$(document).on("click",".ss-photo-delete",function(a){a.stopPropagation();a=this.getAttribute("data-ss-photo-id");$.ajax({url:"/ajax/user/delete_photo",type:"POST",data:{id:a}}).done(function(a){console.log(a)})});$("#right-calendar").datepicker();
$(".ss-search-anything").autocomplete({minLength:1,source:function(a,c){$.ajax({url:"/ajax/search",data:{search:a.term},dataType:"json",type:"GET",success:function(a){c(a)}})},select:function(a,c){a.preventDefault();window.location.href="/"+c.item.type.toLowerCase()+"/"+c.item.id}}).data("ui-autocomplete")._renderItem=function(a,c){var h='<a class="ss-search-result">';""!=c.profile_picture&&(h+='<div class="profile-picture ss-search-result-img"><img src="'+c.profile_picture+'" width="50" /></div>');
h=h+'<div class="ss-search-result-content">'+(c.name+"<br />");if("Group"==c.type||"Classroom"==c.type)h+='<span class="ss-search-result-data"><span class="bold">'+c.data+"</span> members</span>";if(("Highschool"==c.type||"University"==c.type||"User"==c.type)&&c.data)h+='<span class="ss-search-result-data">'+c.data+"</span>";h+="</div>";h+='<div class="clear"></div>';h+="</a>";return $("<li>").append(h).appendTo(a)};$(".ss-search-anything").autocomplete("widget").addClass("ss-search-ul");$(".classroom-autocomplete").autocomplete({minLength:1,source:function(a,c){$.ajax({url:"/ajax/classroom/json",data:{search:a.term},dataType:"json",type:"GET",success:function(a){c(a)}})},select:function(a,c){a.preventDefault();window.location.href="/classroom/"+c.item.id}});for(i=0;i<$(".classroom-autocomplete").length;i++)$($(".classroom-autocomplete")[i]).data("ui-autocomplete")._renderItem=function(a,c){return $("<li>").append("<a>"+c.name+"</a>").appendTo(a)};
$(".group-autocomplete").autocomplete({minLength:1,source:function(a,c){$.ajax({url:"/ajax/group/json",data:{search:a.term},dataType:"json",type:"GET",success:function(a){c(a)}})},select:function(a,c){a.preventDefault();window.location.href="/group/"+c.item.id}});for(i=0;i<$(".group-autocomplete").length;i++)$($(".group-autocomplete")[i]).data("ui-autocomplete")._renderItem=function(a,c){return $("<li>").append("<a>"+c.name+"</a>").appendTo(a)};
$(".create-classroom").click(function(){window.location.href="/classroom/create?name="+encodeURIComponent($(".classroom-autocomplete").val())});$(".create-group").click(function(){window.location.href="/group/create?name="+encodeURIComponent($(".group-autocomplete").val())});$(".page-settings").on("click",".ss-delete",function(){var a=this.getAttribute("data-ss-id");$.ajax({url:"/ajax/settings/delete_education",type:"POST",data:{id:a}}).done(function(a){});$(this).parents("tr").remove()});$(".page-settings").on("click",".ss-add-education",function(){var a=$(".hide.snippet-add-education").clone().removeClass("hide"),a=$("<tr></tr>").append($("<td></td>").append(a));$(".ss-table-education").prepend(a);update_autocomplete_my_profile()});
$(".page-settings").on("change",'select[name="type[]"]',function(){var a=$(this).siblings('input[name="name[]"]');a.val("");a.removeClass("university-autocomplete");a.removeClass("highschool-autocomplete");"highschool"==this.value?a.addClass("highschool-autocomplete"):a.addClass("university-autocomplete");$(this).siblings('input[name="education_id[]"]').val("0");update_autocomplete_my_profile()});
function update_autocomplete_my_profile(){$(".highschool-autocomplete").autocomplete({minLength:1,source:function(a,c){$.ajax({url:"/ajax/highschool/json",data:{search:a.term},dataType:"json",type:"GET",success:function(a){c(a)}})},select:function(a,c){a.preventDefault();$(this).val(c.item.name);$(this).siblings('input[name="education_id[]"]').val(c.item.id)}});for(i=0;i<$(".highschool-autocomplete").length;i++)$($(".highschool-autocomplete")[i]).data("ui-autocomplete")._renderItem=function(a,c){return $("<li>").append("<a>"+
c.name+'<br /><span style="font-size: 12px;">'+c.address+"</span></a>").appendTo(a)};$(".university-autocomplete").autocomplete({minLength:1,source:function(a,c){$.ajax({url:"/ajax/university/json",data:{search:a.term},dataType:"json",type:"GET",success:function(a){c(a)}})},select:function(a,c){a.preventDefault();$(this).val(c.item.name);$(this).siblings('input[name="education_id[]"]').val(c.item.id)}});for(i=0;i<$(".university-autocomplete").length;i++)$($(".university-autocomplete")[i]).data("ui-autocomplete")._renderItem=
function(a,c){return $("<li>").append("<a>"+c.name+'<br /><span style="font-size: 12px;">'+c.address+"</span></a>").appendTo(a)};$(".major-autocomplete").autocomplete({minLength:1,source:function(a,c){$.ajax({url:"/ajax/major/json",data:{search:a.term},dataType:"json",type:"GET",success:function(a){c(a)}})},select:function(a,c){a.preventDefault();$(this).val(c.item.title);$(this).siblings('input[name="major_id[]"]').val(c.item.id)}});for(i=0;i<$(".major-autocomplete").length;i++)$($(".major-autocomplete")[i]).data("ui-autocomplete")._renderItem=
function(a,c){return $("<li>").append("<a>"+c.title+"</a>").appendTo(a)}};$(".page-settings").on("click",".cg-leave-button",function(){var a=this.getAttribute("data-cg-id"),c="/ajax/"+this.getAttribute("data-cg-type")+"/quit";$.ajax({url:c,type:"POST",data:{id:a}}).done(function(a){window.location.reload()})});$(".page-settings").on("click",".cg-join-button",function(){var a=this.getAttribute("data-cg-id"),c="/ajax/"+this.getAttribute("data-cg-type")+"/join";$.ajax({url:c,type:"POST",data:{id:a}}).done(function(a){window.location.reload()})});$(document).on("click",".join-cg",function(){var a=this.getAttribute("data-what"),a="/ajax/"+a+"/join",c=this.getAttribute("data-id");$(this).hide();$.ajax({url:a,type:"POST",data:{id:c}}).done(function(a){$("h2.count-members").text(parseInt($("h2.count-members").text())+1)})});0!=$(".message-page").length&&($(window).resize(function(){var a=$(window).height()-200;$(".layout-sidebar-right .ss-container").height()>=a&&(a=$(".layout-sidebar-right .ss-container").height());$(".message-container-left").height(a);$(".message-container-main").height(a-100)}),$(window).load(function(){$(window).resize();$(".message-container-main, .message-container-left").mCustomScrollbar();$(".layout-main .message-container-main").mCustomScrollbar("scrollTo","bottom")}));
$(".layout-sidebar.message-page").on("click",".conversation-item",function(){var a=this.getAttribute("data-uid");$(".conversation-item").removeClass("is-selected");$(this).addClass("is-selected");$(".message-container-main .mCSB_container").html("");$(".message-send")[0].setAttribute("data-uid",a);$.ajax({url:"/ajax/messages/get_conversation",type:"GET",data:{uid:a}}).done(function(a){$.each(a,function(a,c){var b=$(".snippet-message").clone().removeClass("snippet-message");b.addClass(c.type+"-message");
$(".message-content p",b).text_multiline(c.message);$(".message-time",b)[0].setAttribute("data-time",c.created_at);$(".message-picture img",b)[0].setAttribute("src",c.message_picture);$(".message-container-main .mCSB_container").append(b);b.removeClass("hide")});convert_time();$(".layout-main .message-container-main").mCustomScrollbar("update");$(".layout-main .message-container-main").mCustomScrollbar("scrollTo","bottom")})});
$(".layout-main.message-page").on("click",".message-send",function(){var a=$(".message-new textarea"),c=$(this)[0].getAttribute("data-uid");a.val($.trim(a.val()));if(""!=a.val()){var h=$(".snippet-message").clone().removeClass("snippet-message");h.addClass("sent-message");$(".message-content p",h).text_multiline(a.val());$(".message-time",h)[0].setAttribute("data-time",Math.round(new Date/1E3));$(".message-container-main .mCSB_container").append(h);h.removeClass("hide");convert_time();$(".layout-main .message-container-main").mCustomScrollbar("update");
$(".layout-main .message-container-main").mCustomScrollbar("scrollTo","bottom");$.ajax({url:"/ajax/messages/send_message",type:"POST",data:{message:a.val(),uid:c}}).done(function(a){});a.val("")}});$(document).on("mouseenter",".friend",function(){$("span",this).fadeIn();$(".friend-hover",this).fadeIn()}).on("mouseleave",".friend",function(){$("span",this).fadeOut();$(".friend-hover",this).fadeOut()});$(document).on("click",".add-friend-button",function(){var a=this.getAttribute("data-uid");$(this).hide();$.ajax({url:"/ajax/friendship/send_request",method:"POST",data:{id:a}}).done(function(a){})});function header_close_extended(){$(".header-extended").each(function(){"none"!=$(this).css("display")&&$(this).animate({height:"toggle"})});"none"!=$(".header-settings-extended").css("display")&&$(".header-settings-extended").animate({height:"toggle"})}$(document).on("click",function(){header_close_extended()});
$(document).on("click",".header-settings-icon",function(a){"none"==$(".header-settings-extended").css("display")&&header_close_extended();$(".header-settings-extended").animate({height:"toggle"});a.stopPropagation()});$(document).on("click",".header-friend-icon",function(a){"none"==$(".header-friend-extended").css("display")&&header_close_extended();$(".header-friend-extended").animate({height:"toggle"});a.stopPropagation()});
$(document).on("click",".header-notif-icon",function(a){"none"==$(".header-notif-extended").css("display")&&header_close_extended();$(".header-notif-extended").animate({height:"toggle"});a.stopPropagation()});$(document).on("click",".header-chat-icon",function(a){"none"==$(".header-chat-extended").css("display")&&header_close_extended();$(".header-chat-extended").animate({height:"toggle"});a.stopPropagation()});
$(document).on("click",".accept-friendship-request",function(){var a=this.getAttribute("data-uid");$(this).parents(".header-extended-item").hide();$.ajax({url:"/ajax/friendship/accept_request",method:"POST",data:{id:a}}).done(function(a){})});$(document).on("click",".decline-friendship-request",function(){var a=this.getAttribute("data-uid");$(this).parents(".header-extended-item").hide();$.ajax({url:"/ajax/friendship/decline_request",method:"POST",data:{id:a}}).done(function(a){})});
