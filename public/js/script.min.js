(function(a){var b,e,g={method:"GET",contentType:"json",queryParam:"q",searchDelay:300,minChars:1,propertyToSearch:"name",jsonContainer:null,hintText:"Type in a search term",noResultsText:"No results",searchingText:"Searching...",deleteText:"&times;",animateDropdown:!0,tokenLimit:null,tokenDelimiter:",",preventDuplicates:!1,tokenValue:"id",prePopulate:null,processPrePopulate:!1,idPrefix:"token-input-",resultsFormatter:function(a){return"<li>"+a[this.propertyToSearch]+"</li>"},tokenFormatter:function(a){return"<li><p>"+
a[this.propertyToSearch]+"</p></li>"},onResult:null,onAdd:null,onDelete:null,onReady:null},n={tokenList:"token-input-list",token:"token-input-token",tokenDelete:"token-input-delete-token",selectedToken:"token-input-selected-token",highlightedToken:"token-input-highlighted-token",dropdown:"token-input-dropdown",dropdownItem:"token-input-dropdown-item",dropdownItem2:"token-input-dropdown-item2",selectedDropdownItem:"token-input-selected-dropdown-item",inputToken:"token-input-input-token"};b=0;e=1;var l=
{init:function(b,e){var c=a.extend({},g,e||{});return this.each(function(){a(this).data("tokenInputObject",new a.TokenList(this,b,c))})},clear:function(){this.data("tokenInputObject").clear();return this},add:function(a){this.data("tokenInputObject").add(a);return this},remove:function(a){this.data("tokenInputObject").remove(a);return this},get:function(){return this.data("tokenInputObject").getTokens()}};a.fn.tokenInput=function(a){return l[a]?l[a].apply(this,Array.prototype.slice.call(arguments,
1)):l.init.apply(this,arguments)};a.TokenList=function(g,l,c){function J(){null!==c.tokenLimit&&p>=c.tokenLimit&&(h.hide(),t())}function K(u){var b=c.tokenFormatter(u),b=a(b).addClass(c.classes.token).insertBefore(v);a("<span>"+c.deleteText+"</span>").addClass(c.classes.tokenDelete).appendTo(b).click(function(){B(a(this).parent());m.change();return!1});var d={id:u.id};d[c.propertyToSearch]=u[c.propertyToSearch];a.data(b.get(0),"tokeninput",u);q=q.slice(0,r).concat([d]).concat(q.slice(r));r++;L(q,
m);p+=1;null!==c.tokenLimit&&p>=c.tokenLimit&&(h.hide(),t());return b}function D(u){var b=c.onAdd;if(0<p&&c.preventDuplicates){var d=null;w.children().each(function(){var c=a(this),b=a.data(c.get(0),"tokeninput");if(b&&b.id===u.id)return d=c,!1});if(d){A(d);v.insertAfter(d);h.focus();return}}if(null==c.tokenLimit||p<c.tokenLimit)K(u),J();h.val("");t();a.isFunction(b)&&b.call(m,u)}function A(a){a.addClass(c.classes.selectedToken);k=a.get(0);h.val("");t()}function y(a,f){a.removeClass(c.classes.selectedToken);
k=null;f===b?(v.insertBefore(a),r--):f===e?(v.insertAfter(a),r++):(v.appendTo(w),r=p);h.focus()}function B(b){var f=a.data(b.get(0),"tokeninput"),d=c.onDelete,z=b.prevAll().length;z>r&&z--;b.remove();k=null;h.focus();q=q.slice(0,z).concat(q.slice(z+1));z<r&&r--;L(q,m);p-=1;null!==c.tokenLimit&&h.show().val("").focus();a.isFunction(d)&&d.call(m,f)}function L(b,f){var d=a.map(b,function(a){return a[c.tokenValue]});f.val(d.join(c.tokenDelimiter))}function t(){x.hide().empty();s=null}function C(){x.css({position:"absolute",
top:a(w).offset().top+a(w).outerHeight(),left:a(w).offset().left,zindex:999}).show()}function E(b,f){if(f&&f.length){x.empty();var d=a("<ul>").appendTo(x).mouseover(function(c){F(a(c.target).closest("li"))}).mousedown(function(c){D(a(c.target).closest("li").data("tokeninput"));m.change();return!1}).hide();a.each(f,function(f,g){var e=c.resultsFormatter(g),e=e.replace(RegExp("(?![^&;]+;)(?!<[^<>]*)("+g[c.propertyToSearch]+")(?![^<>]*>)(?![^&;]+;)","g"),g[c.propertyToSearch].replace(RegExp("(?![^&;]+;)(?!<[^<>]*)("+
b+")(?![^<>]*>)(?![^&;]+;)","gi"),"<b>$1</b>")),e=a(e).appendTo(d);f%2?e.addClass(c.classes.dropdownItem):e.addClass(c.classes.dropdownItem2);0===f&&F(e);a.data(e.get(0),"tokeninput",g)});C();c.animateDropdown?d.slideDown("fast"):d.show()}else c.noResultsText&&(x.html("<p>"+c.noResultsText+"</p>"),C())}function F(b){b&&(s&&(a(s).removeClass(c.classes.selectedDropdownItem),s=null),b.addClass(c.classes.selectedDropdownItem),s=b.get(0))}function M(){var b=h.val().toLowerCase();b&&b.length&&(k&&y(a(k),
e),b.length>=c.minChars?(c.searchingText&&(x.html("<p>"+c.searchingText+"</p>"),C()),clearTimeout(N),N=setTimeout(function(){P(b)},c.searchDelay)):t())}function P(b){var f=b+G(),d=H.get(f);if(d)E(b,d);else if(c.url){var d=G(),e={data:{}};-1<d.indexOf("?")?(d=d.split("?"),e.url=d[0],d=d[1].split("&"),a.each(d,function(a,b){var c=b.split("=");e.data[c[0]]=c[1]})):e.url=d;e.data[c.queryParam]=b;e.type=c.method;e.dataType=c.contentType;c.crossDomain&&(e.dataType="jsonp");e.success=function(d){a.isFunction(c.onResult)&&
(d=c.onResult.call(m,d));H.add(f,c.jsonContainer?d[c.jsonContainer]:d);h.val().toLowerCase()===b&&E(b,c.jsonContainer?d[c.jsonContainer]:d)};a.ajax(e)}else c.local_data&&(d=a.grep(c.local_data,function(a){return-1<a[c.propertyToSearch].toLowerCase().indexOf(b.toLowerCase())}),a.isFunction(c.onResult)&&(d=c.onResult.call(m,d)),H.add(f,d),E(b,d))}function G(){var a=c.url;"function"==typeof c.url&&(a=c.url.call());return a}"string"===a.type(l)||"function"===a.type(l)?(c.url=l,l=G(),void 0===c.crossDomain&&
(-1===l.indexOf("://")?c.crossDomain=!1:c.crossDomain=location.href.split(/\/+/g)[1]!==l.split(/\/+/g)[1])):"object"===typeof l&&(c.local_data=l);c.classes?c.classes=a.extend({},n,c.classes):c.theme?(c.classes={},a.each(n,function(a,b){c.classes[a]=b+"-"+c.theme})):c.classes=n;var q=[],p=0,H=new a.TokenList.Cache,N,I,h=a('<input type="text"  autocomplete="off">').css({outline:"none"}).attr("id",c.idPrefix+g.id).focus(function(){if((null===c.tokenLimit||c.tokenLimit!==p)&&c.hintText)x.html("<p>"+c.hintText+
"</p>"),C()}).blur(function(){t();a(this).val("")}).bind("keyup keydown blur update",function(){if(I!==(I=h.val())){var a=I.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");O.html(a);h.width(O.width()+30)}}).keydown(function(c){var f,d;switch(c.keyCode){case 37:case 39:case 38:case 40:if(a(this).val())return f=null,f=40===c.keyCode||39===c.keyCode?a(s).next():a(s).prev(),f.length&&F(f),!1;f=v.prev();d=v.next();f.length&&f.get(0)===k||d.length&&d.get(0)===k?37===c.keyCode||
38===c.keyCode?y(a(k),b):y(a(k),e):(37===c.keyCode||38===c.keyCode)&&f.length?A(a(f.get(0))):(39===c.keyCode||40===c.keyCode)&&d.length&&A(a(d.get(0)));break;case 8:f=v.prev();if(a(this).val().length)1===a(this).val().length?t():setTimeout(function(){M()},5);else return k?(B(a(k)),m.change()):f.length&&A(a(f.get(0))),!1;break;case 9:case 13:case 108:case 188:if(s)return D(a(s).data("tokeninput")),m.change(),!1;break;case 27:return t(),!0;default:String.fromCharCode(c.which)&&setTimeout(function(){M()},
5)}}),m=a(g).hide().val("").focus(function(){h.focus()}).blur(function(){h.blur()}),k=null,r=0,s=null,w=a("<ul />").addClass(c.classes.tokenList).click(function(c){if((c=a(c.target).closest("li"))&&c.get(0)&&a.data(c.get(0),"tokeninput")){var b=k;k&&y(a(k),2);b===c.get(0)?y(c,2):A(c)}else k&&y(a(k),2),h.focus()}).mouseover(function(b){(b=a(b.target).closest("li"))&&k!==this&&b.addClass(c.classes.highlightedToken)}).mouseout(function(b){(b=a(b.target).closest("li"))&&k!==this&&b.removeClass(c.classes.highlightedToken)}).insertBefore(m),
v=a("<li />").addClass(c.classes.inputToken).appendTo(w).append(h),x=a("<div>").addClass(c.classes.dropdown).appendTo("body").hide(),O=a("<tester/>").insertAfter(h).css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:h.css("fontSize"),fontFamily:h.css("fontFamily"),fontWeight:h.css("fontWeight"),letterSpacing:h.css("letterSpacing"),whiteSpace:"nowrap"});m.val("");g=c.prePopulate||m.data("pre");c.processPrePopulate&&a.isFunction(c.onResult)&&(g=c.onResult.call(m,g));g&&g.length&&a.each(g,
function(a,b){K(b);J()});a.isFunction(c.onReady)&&c.onReady.call();this.clear=function(){w.children("li").each(function(){0===a(this).children("input").length&&B(a(this))})};this.add=function(a){D(a)};this.remove=function(b){w.children("li").each(function(){if(0===a(this).children("input").length){var c=a(this).data("tokeninput"),d=!0,e;for(e in b)if(b[e]!==c[e]){d=!1;break}d&&B(a(this))}})};this.getTokens=function(){return q}};a.TokenList.Cache=function(b){var e=a.extend({max_size:500},b),c={},g=
0;this.add=function(a,b){g>e.max_size&&(c={},g=0);c[a]||(g+=1);c[a]=b};this.get=function(a){return c[a]}}})(jQuery);$(document).on("click",".ss-link",function(){window.location.href=this.getAttribute("data-ss-link")});$(document).on("click",".header-settings-icon",function(){$(".header-settings-extended").animate({height:"toggle"})});$(document).on("click",".add-friend-button",function(){var a=this.getAttribute("data-uid");$(this).hide();$.ajax({url:"/ajax/user/send_friend_request",method:"POST",data:{id:a}}).done(function(a){})});function dateToString(a){var b=a.getDate(),e="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a.getMonth()],g=a.getFullYear(),n=a.getHours();a=a.getMinutes();var l="AM";12<=n&&(n-=12,l="PM");0==n&&(n=12);return""+e+" "+(9>=b?"0"+b:b)+", "+g+" at "+(9>=n?"0"+n:n)+":"+(9>=a?"0"+a:a)+" "+l}
function convert_time(){$(".time-ago").each(function(){if(""==this.getAttribute("data-time"))return!0;var a=new Date(1E3*this.getAttribute("data-time")),b=Math.round((new Date-a)/1E3);0>b?(b=0-b,60>b?$(this).html("in a few seconds"):(b=Math.floor(b/60),10>b?$(this).html("in about "+b+" minutes"):$(this).html(dateToString(a)))):60>b?$(this).html("a few seconds ago"):(b=Math.floor(b/60),60>b?$(this).html("about "+b+" minute"+(1<b?"s":"")+" ago"):(b=Math.floor(b/60),24>b?$(this).html("about "+b+" hours ago"):
$(this).html(dateToString(a))))})}convert_time();var convert_time_internval=setInterval(convert_time,6E4);$(document).on("click",".page-tab",function(){var a=".page-tab-"+this.getAttribute("data-ss-tab");$(".page-tab").removeClass("is-active");$(this).addClass("is-active");$(".page-tab-component").hide();$(a).show()});$(document).on("click",".ss-photo",function(){console.log("--Expand photo")});
$(document).on("change",".ss-picture-upload",function(){var a=this;if(a.files&&a.files[0]){var b=a.files[0];if(!b.type.match(/image.*/))return!1;var e=new FileReader;e.onload=function(b){var e=$(a).parents(".ss-file-wrapper").siblings(".ss-picture-preview");b=$("<img/>").attr("src",b.target.result);e.html(b).show();b.Jcrop({aspectRatio:1,minSize:[50,50],setSelect:[100,100,50,50],onSelect:function(a){$('input[name="profile_x"]').val(a.x);$('input[name="profile_y"]').val(a.y);$('input[name="profile_w"]').val(a.w);
$('input[name="profile_h"]').val(a.h)}})};e.readAsDataURL(b)}});$(document).on("click",".thumb-up",function(){var a=$(this).children(".thumb-up-count"),b=$(this).siblings(".thumb-down").children(".thumb-down-count"),e=this.getAttribute("data-pid");$.ajax({url:"/ajax/post/save_thumb",method:"POST",data:{type:"up",id:e}}).done(function(e){0==e.result?(b.text(parseInt(b.text())-1),a.text(parseInt(a.text())+1)):1==e.result&&a.text(parseInt(a.text())+1)})});
$(document).on("click",".thumb-down",function(){var a=$(this).children(".thumb-down-count"),b=$(this).siblings(".thumb-up").children(".thumb-up-count"),e=this.getAttribute("data-pid");$.ajax({url:"/ajax/post/save_thumb",method:"POST",data:{type:"down",id:e}}).done(function(e){0==e.result?(a.text(parseInt(a.text())+1),b.text(parseInt(b.text())-1)):1==e.result&&a.text(parseInt(a.text())+1)})});$(document).on("change",'[name="user_photos[]"]',function(){var a=new FormData;for(i=0;i<this.files.length;i++)a.append("user_photos[]",this.files[i]);$.ajax({url:"/ajax/user/upload_photos",type:"POST",data:a,processData:!1,contentType:!1,dataType:"json"}).done(function(a){console.log(a)})});
$(document).on("mouseenter",".ss-photo",function(){$(this).children(".ss-photo-hover").fadeIn();$(this).children(".ss-photo-delete").fadeIn()}).on("mouseleave",".ss-photo",function(){$(this).children(".ss-photo-hover").fadeOut();$(this).children(".ss-photo-delete").fadeOut()});$(document).on("click",".ss-photo-delete",function(a){a.stopPropagation();a=this.getAttribute("data-ss-photo-id");$.ajax({url:"/ajax/user/delete_photo",type:"POST",data:{id:a}}).done(function(a){console.log(a)})});$("#right-calendar").datepicker();$(".page-settings").on("click",".ss-delete",function(){var a=this.getAttribute("data-ss-id");$.ajax({url:"/ajax/settings/delete_education",type:"POST",data:{id:a}}).done(function(a){});$(this).parents("tr").remove()});$(".page-settings").on("click",".ss-add-education",function(){var a=$(".hide.snippet-add-education").clone().removeClass("hide"),a=$("<tr></tr>").append($("<td></td>").append(a));$(".ss-table-education").prepend(a);update_autocomplete_my_profile()});
$(".page-settings").on("change",'select[name="type[]"]',function(){var a=$(this).siblings('input[name="name[]"]');a.val("");a.removeClass("university-autocomplete");a.removeClass("highschool-autocomplete");"highschool"==this.value?a.addClass("highschool-autocomplete"):a.addClass("university-autocomplete");$(this).siblings('input[name="education_id[]"]').val("0");update_autocomplete_my_profile()});
function update_autocomplete_my_profile(){$(".highschool-autocomplete").autocomplete({minLength:1,source:function(a,b){$.ajax({url:"/ajax/highschool/json",data:{search:a.term},dataType:"json",type:"GET",success:function(a){b(a)}})},select:function(a,b){a.preventDefault();$(this).val(b.item.name);$(this).siblings('input[name="education_id[]"]').val(b.item.id)}});for(i=0;i<$(".highschool-autocomplete").length;i++)$($(".highschool-autocomplete")[i]).data("ui-autocomplete")._renderItem=function(a,b){return $("<li>").append("<a>"+
b.name+'<br /><span style="font-size: 12px;">'+b.address+"</span></a>").appendTo(a)};$(".university-autocomplete").autocomplete({minLength:1,source:function(a,b){$.ajax({url:"/ajax/university/json",data:{search:a.term},dataType:"json",type:"GET",success:function(a){b(a)}})},select:function(a,b){a.preventDefault();$(this).val(b.item.name);$(this).siblings('input[name="education_id[]"]').val(b.item.id)}});for(i=0;i<$(".university-autocomplete").length;i++)$($(".university-autocomplete")[i]).data("ui-autocomplete")._renderItem=
function(a,b){return $("<li>").append("<a>"+b.name+'<br /><span style="font-size: 12px;">'+b.address+"</span></a>").appendTo(a)};$(".major-autocomplete").autocomplete({minLength:1,source:function(a,b){$.ajax({url:"/ajax/major/json",data:{search:a.term},dataType:"json",type:"GET",success:function(a){b(a)}})},select:function(a,b){a.preventDefault();$(this).val(b.item.title);$(this).siblings('input[name="major_id[]"]').val(b.item.id)}});for(i=0;i<$(".major-autocomplete").length;i++)$($(".major-autocomplete")[i]).data("ui-autocomplete")._renderItem=
function(a,b){return $("<li>").append("<a>"+b.title+"</a>").appendTo(a)}};$(document).on("click",".join-cg",function(){var a=this.getAttribute("data-what"),a="/ajax/"+a+"/join",b=this.getAttribute("data-id");$(this).hide();$.ajax({url:a,type:"POST",data:{id:b}}).done(function(a){$("h2.count-members").text(parseInt($("h2.count-members").text())+1)})});
