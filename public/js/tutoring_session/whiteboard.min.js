var paths=[],styles=[{strokeColor:"#ed1c24",strokeWidth:2}];styles[1]=styles[0];project.layers[0].redoChildren=[];
var tsUndo=function(){null!==project.activeLayer.lastChild&&(project.activeLayer.redoChildren.push(project.activeLayer.lastChild),project.activeLayer.lastChild.remove(),project.view.update())},tsRedo=function(){if(0!==project.activeLayer.redoChildren.length){var b=project.activeLayer.redoChildren.pop();project.activeLayer.addChild(b);project.view.update()}},tsClear=function(){project.activeLayer.removeChildren();project.view.update()};var pencilTool=new Tool;pencilTool.minDistance=10;pencilTool.onMouseDown=function(b,a){a="undefined"!==typeof a?a:0;paths[a]=new Path;paths[a].style=styles[a];paths[a].add(b.point)};pencilTool.onMouseDrag=function(b,a){a="undefined"!==typeof a?a:0;paths[a].add(b.point);paths[a].smooth()};var eraseTool=new Tool;eraseTool.minDistance=10;eraseTool.onMouseDown=function(b,a){a="undefined"!==typeof a?a:0;paths[a]=new Path;paths[a].originalColor=styles[a].strokeColor;styles[a].strokeColor="#fff";paths[a].style=styles[a];paths[a].add(b.point)};eraseTool.onMouseDrag=function(b,a){a="undefined"!==typeof a?a:0;paths[a].add(b.point);paths[a].smooth()};eraseTool.onMouseUp=function(b,a){a="undefined"!==typeof a?a:0;paths[a].add(b.point);paths[a].smooth();styles[a].strokeColor=paths[a].originalColor};var rectangleTool=new Tool;rectangleTool.minDistance=10;rectangleTool.onMouseDown=function(b,a){a="undefined"!==typeof a?a:0;paths[a]=new Path;paths[a].style=styles[a];paths[a].startingPoint=b.point};rectangleTool.onMouseDrag=function(b,a){a="undefined"!==typeof a?a:0;var c=paths[a];paths[a].remove();paths[a]=new Path.Rectangle(c.startingPoint,b.point);paths[a].style=styles[a];paths[a].startingPoint=c.startingPoint};var ellipseTool=new Tool;ellipseTool.minDistance=10;ellipseTool.onMouseDown=function(b,a){a="undefined"!==typeof a?a:0;paths[a]=new Path;paths[a].style=styles[a];paths[a].startingPoint=b.point};ellipseTool.onMouseDrag=function(b,a){a="undefined"!==typeof a?a:0;var c=paths[a];paths[a].remove();var d=new Rectangle(c.startingPoint,b.point);paths[a]=new Path.Ellipse(d);paths[a].style=styles[a];paths[a].startingPoint=c.startingPoint};var lineTool=new Tool;lineTool.minDistance=10;lineTool.onMouseDown=function(b,a){a="undefined"!==typeof a?a:0;paths[a]=new Path;paths[a].style=styles[a];paths[a].startingPoint=b.point};lineTool.onMouseDrag=function(b,a){a="undefined"!==typeof a?a:0;var c=paths[a];paths[a].remove();paths[a]=new Path.Line(c.startingPoint,b.point);paths[a].style=styles[a];paths[a].startingPoint=c.startingPoint};var tsAddTab=function(){var b=parseInt($(".ts-whiteboard-tab").last()[0].getAttribute("data-ts-tab-id"));if(6>b){$(".ts-whiteboard-tab").removeClass("is-selected");var a=$(".ts-whiteboard-tab").first().clone();a.text("Tab "+(b+2));a[0].setAttribute("data-ts-tab-id",b+1);a.addClass("is-selected");$(".ts-whiteboard-tabs-holder").append(a);project.layers[b+1]=new Layer;project.layers[b+1].redoChildren=[];activateLayer(b+1)}},tsRemoveTab=function(){var b=parseInt($(".ts-whiteboard-tab").last()[0].getAttribute("data-ts-tab-id"));
0!==b&&($(".ts-whiteboard-tab").last().hasClass("is-selected")&&($(".ts-whiteboard-tab").eq(-2).addClass("is-selected"),activateLayer(b-1)),$(".ts-whiteboard-tab").last().remove(),project.layers[b].remove())},tsFocusTab=function(b){$(".ts-whiteboard-tab").removeClass("is-selected");$('.ts-whiteboard-tab[data-ts-tab-id="'+b+'"]').addClass("is-selected");activateLayer(b)},activateLayer=function(b){for(i=0;i<project.layers.length;i++)project.layers[i].visible=!1;project.layers[b].visible=!0;project.layers[b].activate();
project.view.update()};var selectTool=function(b){$(".ts-whiteboard-tool").removeClass("is-selected");$(".ts-whiteboard-tools-"+b).addClass("is-selected");switch(b){case "pencil":pencilTool.activate();break;case "erase":eraseTool.activate();break;case "rectangle":rectangleTool.activate();break;case "ellipse":ellipseTool.activate();break;default:lineTool.activate()}};$(document).on("click",".ts-whiteboard-tools-pencil",function(){selectTool("pencil")});$(document).on("click",".ts-whiteboard-tools-erase",function(){selectTool("erase")});
$(document).on("click",".ts-whiteboard-tools-rectangle",function(){selectTool("rectangle")});$(document).on("click",".ts-whiteboard-tools-ellipse",function(){selectTool("ellipse")});$(document).on("click",".ts-whiteboard-tools-line",function(){selectTool("line")});$(document).on("click",".ts-whiteboard-undo",function(){tsUndo()});$(document).on("click",".ts-whiteboard-redo",function(){tsRedo()});$(document).on("click",".ts-whiteboard-clear",function(){tsClear()});
$(document).on("click","#ts-whiteboard-tab-add",function(){tsAddTab()});$(document).on("click",".ts-whiteboard-tools-remove-tab",function(){tsRemoveTab()});$(document).on("click",".ts-whiteboard-tab",function(){tsFocusTab(this.getAttribute("data-ts-tab-id"))});$(document).on("click",".ts-whiteboard-tools-colors",function(){36==$(this).width()?$(this).animate({width:311}):$(this).animate({width:36})});
$(document).on("click",".ts-whiteboard-tools-color",function(){var b;b="ts-whiteboard-tools-color-"+this.getAttribute("data-ts-color-name");var a=this.getAttribute("data-ts-color-name"),c=this.getAttribute("data-ts-color"),d;d="ts-whiteboard-tools-color-"+$(".ts-whiteboard-tools-color").first()[0].getAttribute("data-ts-color-name");var e=$(".ts-whiteboard-tools-color").first()[0].getAttribute("data-ts-color-name"),f=$(".ts-whiteboard-tools-color").first()[0].getAttribute("data-ts-color");$(".ts-whiteboard-tools-color").first().removeClass(d).addClass(b);
$(".ts-whiteboard-tools-color").first()[0].setAttribute("data-ts-color-name",a);$(".ts-whiteboard-tools-color").first()[0].setAttribute("data-ts-color",c);$(this).removeClass(b).addClass(d);$(this)[0].setAttribute("data-ts-color-name",e);$(this)[0].setAttribute("data-ts-color",f);styles[0].strokeColor=c});$(document).on("click",".ts-whiteboard-tools-sizes",function(){36==$(this).width()?$(this).animate({width:233}):$(this).animate({width:36})});
$(document).on("click",".ts-whiteboard-tools-size",function(){var b=parseInt(this.getAttribute("data-ts-size")),a=parseInt($(".ts-whiteboard-tools-size").first()[0].getAttribute("data-ts-size"));$(".ts-whiteboard-tools-size").first()[0].setAttribute("data-ts-size",b);$(".ts-whiteboard-tools-size").first().text(b+"px");this.setAttribute("data-ts-size",a);$(this).text(a+"px");styles[0].strokeWidth=b});
